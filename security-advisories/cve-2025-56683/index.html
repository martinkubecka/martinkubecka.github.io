<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application | Martin Kubečka</title><meta name=keywords content="CVE-2025-56683,XSS,DOM-based XSS,Logseq"><meta name=description content="A DOM-based XSS vulnerability in Logseq version 0.10.9 allows Remote Code Execution by injecting malicious JavaScript through unsanitized plugin README content combined with insufficient protocol validation."><meta name=author content="Martin Kubečka"><link rel=canonical href=https://martinkubecka.sk/security-advisories/cve-2025-56683/><link crossorigin=anonymous href=/assets/css/stylesheet.ba00c1f715cc18cbf534f1dd7be1b22fc29e5384ca42c46b68ff6c99b2b92143.css integrity="sha256-ugDB9xXMGMv1NPHde+GyL8KeU4TKQsRraP9smbK5IUM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://martinkubecka.sk/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://martinkubecka.sk/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://martinkubecka.sk/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://martinkubecka.sk/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://martinkubecka.sk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application"><meta property="og:description" content="A DOM-based XSS vulnerability in Logseq version 0.10.9 allows Remote Code Execution by injecting malicious JavaScript through unsanitized plugin README content combined with insufficient protocol validation."><meta property="og:type" content="article"><meta property="og:url" content="https://martinkubecka.sk/security-advisories/cve-2025-56683/"><meta property="og:image" content="https://martinkubecka.sk/images/security-advisories/CVE-2025-56683/icon.png"><meta property="article:section" content="security-advisories"><meta property="article:published_time" content="2025-07-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-01T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://martinkubecka.sk/images/security-advisories/CVE-2025-56683/icon.png"><meta name=twitter:title content="CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application"><meta name=twitter:description content="A DOM-based XSS vulnerability in Logseq version 0.10.9 allows Remote Code Execution by injecting malicious JavaScript through unsanitized plugin README content combined with insufficient protocol validation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Security Advisories","item":"https://martinkubecka.sk/security-advisories/"},{"@type":"ListItem","position":3,"name":"CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application","item":"https://martinkubecka.sk/security-advisories/cve-2025-56683/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application","name":"CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application","description":"A DOM-based XSS vulnerability in Logseq version 0.10.9 allows Remote Code Execution by injecting malicious JavaScript through unsanitized plugin README content combined with insufficient protocol validation.","keywords":["CVE-2025-56683","XSS","DOM-based XSS","Logseq"],"articleBody":"Vulnerability Summary During security testing of the Logseq (Desktop/Android) application [1][2], version 0.10.9, a critical-severity DOM-based Cross-Site Scripting (XSS) vulnerability [3] was identified in the marketplace.html endpoint. An attacker can host a malicious Logseq plugin on GitHub with JavaScript embedded in the plugin’s README.md. When this README is rendered inside the Logseq plugin marketplace, unsanitized input from the document location is directly injected into innerHTML which results in arbitrary JavaScript execution. Furthermore, the absence of an allowlist for shell.openExternal (exposed via window.cljs) allows this DOM-based XSS to escalate to Remote Code Execution (RCE) [4] by abusing system-level protocol handlers.\nTechnical Details DOM-based Cross-Site Scripting (XSS) in the marketplace for plugins File: resources/app/marketplace.html Line: 82 Description: Unsanitized input from the document’s location (URL parameters) is directly injected into the DOM using innerHTML, which can lead to DOM-based XSS (DOMXSS). The rendered README.md content from an attacker-controlled GitHub repository is parsed and inserted into the page without proper sanitization. Vulnerability Explanation: The application parses the plugin’s Github repository README content using marked.parse() and immediately injects it into the DOM via innerHTML (setContent(content)), without applying any HTML sanitization. If an attacker embeds arbitrary JavaScript into the README file of their plugin Github repository, the code will be executed. This attack is DOM-based because the payload is executed client-side and relies on dynamic manipulation of the repo parameter in the URL. . . . \u003cscript\u003e ;(async function () { const app = document.getElementById('app') const url = new URL(location.href) const setMsg = (msg) =\u003e app.innerHTML = `${msg}` const repo = url.searchParams.get('repo') if (!repo) { return setMsg('Repo parameter not found!') } const setContent = (content) =\u003e app.innerHTML = `${content}` const endpoint = (repo, branch, file) =\u003e `https://raw.githubusercontent.com/${repo}/${branch}/${file}` . . . content = marked.parse(content).replace('src=\"./', `src=\"${fixLink('')}`) setContent(content) }()) \u003c/script\u003e . . . Lack of Protocol Validation in Electron’s Window Logic File: src/electron/electron/window.cljs Line: 133 Description: The function open-default-app! calls shell.openExternal to open external URLs, but only filters for a basic set of protocols (http, https, mailto) in a limited conditional. There is no comprehensive allowlist to prevent invoking custom or system-level protocol handlers, leaving the application vulnerable to abuse. Vulnerability Explanation: Electron’s shell.openExternal() has the ability to invoke OS-level protocol handlers. Since there is no strict allowlist enforced here, an attacker who gains JavaScript execution via the aforementioned DOM-based XSS can craft a payload that performs Remote Code Execution (RCE) via system-level protocols. . . . (defn- open-default-app! [url default-open] (let [URL (.-URL URL) parsed-url (try (URL. url) (catch :default _ nil))] (if (and parsed-url (contains? #{\"https:\" \"http:\" \"mailto:\"} (.-protocol parsed-url))) (.openExternal shell url) (when default-open (default-open url))))) . . . CVSS v3.1 Metrics Metric Value Base Score 9.6 (Critical) Vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H Weakness Enumeration CWE ID Description CWE-79 Improper Neutralization of Input During Web Page Generation (‘Cross-site Scripting’) CWE-20 Improper Input Validation (covers the insufficient validation of the repo parameter and lack of filtering in protocol handling) CWE-116 Improper Encoding or Escaping of Output (specific to the unsafe use of innerHTML without sanitization) CWE-184 Incomplete List of Disallowed Inputs (the protocol filter only included a few values instead of using a secure allowlist) CWE-94 Improper Control of Generation of Code (‘Code Injection’) (Arbitrary JavaScript execution, which then calls OS level protocols, effectively becomes code injection) CWE-749 Exposed Dangerous Method or Function (the exposure of shell.openExternal without restriction) Proof of Concept (PoC) Exploit Logseq Desktop/Android application version 0.10.9 was tested on Microsoft Windows 10 and Microsoft Windows 11. For demonstration purposes, Developer Mode must be enabled. To do so, open the application, click on More ( ... icon), select Settings, go to Advanced and enable Developer mode. PoC Github repository: https://github.com/martinkubecka/Logseq-XSS-RCE-PoC PoC video demonstration: https://www.youtube.com/watch?v=cBP4TA-BioY Steps to Reproduce Launch the Logseq application. In the upper-right corner, click on More ( ... icon), choose Plugins, then open the Marketplace. Click on any available plugin, for example: Journals Calendar. Press Ctrl + Shift + I to open DevTools and navigate to the Console tab. Paste and execute the following code to load the malicious README from an attacker-controlled GitHub repository. document.querySelector(\"iframe.lsp-frame-readme\").src = \"lsp://logseq.com/marketplace.html?repo=martinkubecka/Logseq-Testing\"; After executing the command above:\nThe iframe.lsp-frame-readme source is changed to load the README file from the martinkubecka/Logseq-XSS-RCE-PoC GitHub repository. This README contains a benign proof-of-concept demonstrating:\nA basic XSS payload: . A chained XSS to RCE payload using a demonstration system protocol handler, resulting in the calculator app being executed on Windows system: . This PoC demonstrates on a benign example the critical impact of unsanitized user input combined with insufficient protocol filtering.\nRecommended Mitigations To address the DOM-based XSS and RCE risks stemming from the combination of unsanitized HTML rendering and protocol misuse, the following mitigations are recommended:\nSanitize rendered plugin README content in marketplace.html: Input from the repo query parameter is fetched from GitHub and injected directly into the DOM via innerHTML after being parsed by marked.parse(). This content should be sanitized before being inserted. Implement protocol allowlisting in window.cljs: Introduce a strict allowlist of supported protocols and explicitly block others, especially system-level handlers unless explicitly needed for functionality. Vendor Response \u0026 Patch Information The Logseq development team responded promptly to the reported DOM-based XSS vulnerability by integrating the DOMPurify [5] library to sanitize plugin README content rendered in the marketplace. This change mitigates the risk of arbitrary JavaScript execution originating from attacker-controlled plugin metadata.\nThe fix was incorporated in the release based on the Logseq DB branch. Relevant code changes include:\nAddition of the dompurify library to the build process in gulpfile.js. Inclusion of purify.js in the HTML rendering logic in resources/marketplace.html. Sanitization of parsed README content using DOMPurify.sanitize() before injection into the DOM. A minor update in plugins.cljs to ensure correct iframe source resolution. The patch can be reviewed in this GitHub commit.\nWhile the DOM-based XSS was addressed effectively, the second issue, Lack of Protocol Validation in Electron’s Window Logic, remained unresolved at the time of patch confirmation. On April 29th, 2025, this concern was explicitly communicated to the Logseq support team along with a recommendation to assign CVE ID(s) to both vulnerabilities.\nAlthough system-level protocol handlers are not implemented by the Logseq application itself, the lack of strict validation in its shell.openExternal usage enables attackers to exploit them [6]. Electron’s shell.openExternal() API delegates URL handling to the underlying operating system [7]. Once an attacker achieves JavaScript execution, they can invoke handlers such as search-ms:, ms-excel:, or ms-word: to execute arbitrary commands or launch native applications [8]. For instance, abuse of the search-ms: handler has enabled attackers to remotely execute files from SMB shares via malicious search window shortcuts [9]. The infamous Follina vulnerability exploited the ms-msdt: protocol to achieve code execution through a crafted Office document [10]. Likewise, protocols like ms-excel: and ms-word: have been weaponized in phishing campaigns to silently launch Office apps with remote templates [11]. Without proper validation and the use of security best practices, even Electron applications that appear sandboxed can be exploited to interact with the underlying operating system in unintended and potentially high-risk ways.\nReferences [1] https://logseq.com/ [2] https://github.com/logseq/logseq [3] https://portswigger.net/web-security/cross-site-scripting/dom-based [4] https://www.splunk.com/en_us/blog/learn/rce-remote-code-execution.html [5] https://github.com/cure53/DOMPurify [6] https://benjamin-altpeter.de/shell-openexternal-dangers/ [7] https://www.electronjs.org/docs/latest/tutorial/security#15-do-not-use-shellopenexternal-with-untrusted-content [8] https://positive.security/blog/url-open-rce [9] https://www.bleepingcomputer.com/news/security/new-windows-search-zero-day-added-to-microsoft-protocol-nightmare/ [10] https://www.splunk.com/en_us/blog/security/follina-for-protocol-handlers.html [11] https://blog.syss.com/posts/abusing-ms-office-protos/ Timeline 2025-04-23: I disclosed the vulnerabilities to the Logseq support team. 2025-04-25: The Logseq support team acknowledged the findings and addressed the DOM-based Cross-Site Scripting (XSS) vulnerability with a fix. 2025-04-29: I confirmed the patch for the DOM-based XSS and notified the Logseq support team that the Lack of Protocol Validation in Electron’s Window Logic remained unaddressed, I also recommended assigning CVE ID(s) to these findings. 2025-07-08: Due to no follow-up from the Logseq support team regarding the second vulnerability and CVE assignment, I requested CVE ID(s) directly from MITRE. 2025-09-30: CVE ID(s) assigned. 2025-10-01: Public release of the security advisory. ","wordCount":"1288","inLanguage":"en","image":"https://martinkubecka.sk/images/security-advisories/CVE-2025-56683/icon.png","datePublished":"2025-07-01T00:00:00Z","dateModified":"2025-07-01T00:00:00Z","author":{"@type":"Person","name":"Martin Kubečka"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://martinkubecka.sk/security-advisories/cve-2025-56683/"},"publisher":{"@type":"Organization","name":"Martin Kubečka","logo":{"@type":"ImageObject","url":"https://martinkubecka.sk/images/favicon/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://martinkubecka.sk accesskey=h title="$ cd /home/ (Alt + H)">$ cd /home/</a><div class=logo-switches></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://martinkubecka.sk/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://martinkubecka.sk/security-advisories/ title="Security Advisories"><span>Security Advisories</span></a></li><li><a href=https://martinkubecka.sk/library/ title=Library><span>Library</span></a></li><li><a href=https://martinkubecka.sk/about/ title=About><span>About</span></a></li><li><a href=https://martinkubecka.sk/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://openguards.martinkubecka.sk/ title=OpenGuards><span>OpenGuards</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://martinkubecka.sk>Home</a>&nbsp;»&nbsp;<a href=https://martinkubecka.sk/security-advisories/>Security Advisories</a></div><h1 class=post-title>CVE-2025-56683: DOM-based Cross-Site Scripting Leading to Remote Code Execution in Logseq application</h1><div class=post-description>A DOM-based XSS vulnerability in Logseq version 0.10.9 allows Remote Code Execution by injecting malicious JavaScript through unsanitized plugin README content combined with insufficient protocol validation.</div><div class=post-meta><span title='2025-07-01 00:00:00 +0000 +0000'>July 1, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1288 words&nbsp;·&nbsp;Martin Kubečka</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#vulnerability-summary>Vulnerability Summary</a><ul><li><a href=#technical-details>Technical Details</a></li><li><a href=#cvss-v31-metrics>CVSS v3.1 Metrics</a></li><li><a href=#weakness-enumeration>Weakness Enumeration</a></li></ul></li><li><a href=#proof-of-concept-poc-exploit>Proof of Concept (PoC) Exploit</a><ul><li><a href=#steps-to-reproduce>Steps to Reproduce</a></li></ul></li><li><a href=#recommended-mitigations>Recommended Mitigations</a></li><li><a href=#vendor-response--patch-information>Vendor Response & Patch Information</a></li><li><a href=#references>References</a></li><li><a href=#timeline>Timeline</a></li></ul></nav></div></details></div><div class=post-content><h2 id=vulnerability-summary>Vulnerability Summary<a hidden class=anchor aria-hidden=true href=#vulnerability-summary>#</a></h2><p>During security testing of the <strong>Logseq</strong> (Desktop/Android) application <a href=#references>[1]</a><a href=#references>[2]</a>, version <strong>0.10.9</strong>, a critical-severity <strong>DOM-based Cross-Site Scripting (XSS)</strong> vulnerability <a href=#references>[3]</a> was identified in the <code>marketplace.html</code> endpoint. An attacker can host a malicious Logseq plugin on GitHub with JavaScript embedded in the plugin&rsquo;s <code>README.md</code>. When this README is rendered inside the Logseq plugin marketplace, unsanitized input from the document location is directly injected into <code>innerHTML</code> which results in arbitrary JavaScript execution. Furthermore, the absence of an allowlist for <code>shell.openExternal</code> (exposed via <code>window.cljs</code>) allows this DOM-based XSS to escalate to <strong>Remote Code Execution (RCE)</strong> <a href=#references>[4]</a> by abusing system-level protocol handlers.</p><h3 id=technical-details>Technical Details<a hidden class=anchor aria-hidden=true href=#technical-details>#</a></h3><h4 id=dom-based-cross-site-scripting-xss-in-the-marketplace-for-plugins>DOM-based Cross-Site Scripting (XSS) in the marketplace for plugins<a hidden class=anchor aria-hidden=true href=#dom-based-cross-site-scripting-xss-in-the-marketplace-for-plugins>#</a></h4><ul><li><strong>File</strong>: <code>resources/app/marketplace.html</code></li><li><strong>Line</strong>: <a href=https://github.com/logseq/logseq/blob/2d8e80954e5de53d62ff4713de0289e9a21c039d/resources/marketplace.html#L82>82</a></li><li><strong>Description</strong>: Unsanitized input from the document&rsquo;s location (URL parameters) is directly injected into the DOM using <code>innerHTML</code>, which can lead to DOM-based XSS (DOMXSS). The rendered <code>README.md</code> content from an attacker-controlled GitHub repository is parsed and inserted into the page without proper sanitization.</li><li><strong>Vulnerability Explanation</strong>: The application parses the plugin&rsquo;s Github repository README content using <code>marked.parse()</code> and immediately injects it into the DOM via <code>innerHTML</code> (<code>setContent(content)</code>), without applying any <strong>HTML sanitization</strong>. If an attacker embeds arbitrary JavaScript into the README file of their plugin Github repository, the code will be executed. This attack is <strong>DOM-based</strong> because the payload is executed client-side and relies on dynamic manipulation of the <code>repo</code> parameter in the URL.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>.</span> <span class=p>.</span> <span class=p>.</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>script</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>;(</span><span class=kr>async</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;app&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>setMsg</span> <span class=o>=</span> <span class=p>(</span><span class=nx>msg</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>app</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=sb>`&lt;strong&gt;</span><span class=si>${</span><span class=nx>msg</span><span class=si>}</span><span class=sb>&lt;/strong&gt;`</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>repo</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>searchParams</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;repo&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>repo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>setMsg</span><span class=p>(</span><span class=s1>&#39;Repo parameter not found!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>setContent</span> <span class=o>=</span> <span class=p>(</span><span class=nx>content</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>app</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=sb>`&lt;main class=&#34;markdown-body&#34;&gt;</span><span class=si>${</span><span class=nx>content</span><span class=si>}</span><span class=sb>&lt;/main&gt;`</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>endpoint</span> <span class=o>=</span> <span class=p>(</span><span class=nx>repo</span><span class=p>,</span> <span class=nx>branch</span><span class=p>,</span> <span class=nx>file</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=sb>`https://raw.githubusercontent.com/</span><span class=si>${</span><span class=nx>repo</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>branch</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>file</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>.</span> <span class=p>.</span> <span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>content</span> <span class=o>=</span> <span class=nx>marked</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>content</span><span class=p>).</span><span class=nx>replace</span><span class=p>(</span><span class=s1>&#39;src=&#34;./&#39;</span><span class=p>,</span> <span class=sb>`src=&#34;</span><span class=si>${</span><span class=nx>fixLink</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>setContent</span><span class=p>(</span><span class=nx>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}())</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=err>/script&gt;</span>
</span></span><span class=line><span class=cl><span class=p>.</span> <span class=p>.</span> <span class=p>.</span>
</span></span></code></pre></div><h4 id=lack-of-protocol-validation-in-electrons-window-logic>Lack of Protocol Validation in Electron&rsquo;s Window Logic<a hidden class=anchor aria-hidden=true href=#lack-of-protocol-validation-in-electrons-window-logic>#</a></h4><ul><li><strong>File</strong>: <code>src/electron/electron/window.cljs</code></li><li><strong>Line</strong>: <a href=https://github.com/logseq/logseq/blob/2d8e80954e5de53d62ff4713de0289e9a21c039d/src/electron/electron/window.cljs#L133>133</a></li><li><strong>Description</strong>: The function <code>open-default-app!</code> calls <code>shell.openExternal</code> to open external URLs, but only filters for a basic set of protocols (<code>http</code>, <code>https</code>, <code>mailto</code>) in a limited conditional. There is no comprehensive allowlist to prevent invoking custom or system-level protocol handlers, leaving the application vulnerable to abuse.</li><li><strong>Vulnerability Explanation</strong>: Electron&rsquo;s <code>shell.openExternal()</code> has the ability to invoke OS-level protocol handlers. Since there is no strict allowlist enforced here, an attacker who gains JavaScript execution via the aforementioned DOM-based XSS can craft a payload that performs <strong>Remote Code Execution</strong> (RCE) via system-level protocols.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-clojure data-lang=clojure><span class=line><span class=cl><span class=k>. . </span><span class=nv>.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=kd>defn- </span><span class=nv>open-default-app!</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nv>url</span> <span class=nv>default-open</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>let </span><span class=p>[</span><span class=nv>URL</span> <span class=p>(</span><span class=nf>.-URL</span> <span class=nv>URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>parsed-url</span> <span class=p>(</span><span class=nf>try</span> <span class=p>(</span><span class=nf>URL.</span> <span class=nv>url</span><span class=p>)</span> <span class=p>(</span><span class=nf>catch</span> <span class=ss>:default</span> <span class=nv>_</span> <span class=nv>nil</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>and </span><span class=nv>parsed-url</span> <span class=p>(</span><span class=nb>contains? </span><span class=o>#</span><span class=p>{</span><span class=s>&#34;https:&#34;</span> <span class=s>&#34;http:&#34;</span> <span class=s>&#34;mailto:&#34;</span><span class=p>}</span> <span class=p>(</span><span class=nf>.-protocol</span> <span class=nv>parsed-url</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>.openExternal</span> <span class=nv>shell</span> <span class=nv>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>when </span><span class=nv>default-open</span> <span class=p>(</span><span class=nf>default-open</span> <span class=nv>url</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=k>. . </span><span class=nv>.</span>
</span></span></code></pre></div><h3 id=cvss-v31-metrics>CVSS v3.1 Metrics<a hidden class=anchor aria-hidden=true href=#cvss-v31-metrics>#</a></h3><table><thead><tr><th>Metric</th><th>Value</th></tr></thead><tbody><tr><td>Base Score</td><td>9.6 (<strong>Critical</strong>)</td></tr><tr><td>Vector</td><td><code>CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H</code></td></tr></tbody></table><h3 id=weakness-enumeration>Weakness Enumeration<a hidden class=anchor aria-hidden=true href=#weakness-enumeration>#</a></h3><table><thead><tr><th>CWE ID</th><th>Description</th></tr></thead><tbody><tr><td><a href=http://cwe.mitre.org/data/definitions/79.html>CWE-79</a></td><td>Improper Neutralization of Input During Web Page Generation (&lsquo;Cross-site Scripting&rsquo;)</td></tr><tr><td><a href=https://cwe.mitre.org/data/definitions/20.html>CWE-20</a></td><td>Improper Input Validation (covers the insufficient validation of the <code>repo</code> parameter and lack of filtering in protocol handling)</td></tr><tr><td><a href=https://cwe.mitre.org/data/definitions/116.html>CWE-116</a></td><td>Improper Encoding or Escaping of Output (specific to the unsafe use of <code>innerHTML</code> without sanitization)</td></tr><tr><td><a href=https://cwe.mitre.org/data/definitions/184.html>CWE-184</a></td><td>Incomplete List of Disallowed Inputs (the protocol filter only included a few values instead of using a secure allowlist)</td></tr><tr><td><a href=https://cwe.mitre.org/data/definitions/94.html>CWE-94</a></td><td>Improper Control of Generation of Code (&lsquo;Code Injection&rsquo;) (Arbitrary JavaScript execution, which then calls OS level protocols, effectively becomes code injection)</td></tr><tr><td><a href=https://cwe.mitre.org/data/definitions/749.html>CWE-749</a></td><td>Exposed Dangerous Method or Function (the exposure of shell.openExternal without restriction)</td></tr></tbody></table><hr><h2 id=proof-of-concept-poc-exploit>Proof of Concept (PoC) Exploit<a hidden class=anchor aria-hidden=true href=#proof-of-concept-poc-exploit>#</a></h2><blockquote><ul><li>Logseq Desktop/Android application version 0.10.9 was tested on Microsoft Windows 10 and Microsoft Windows 11.</li><li>For demonstration purposes, <strong>Developer Mode</strong> must be enabled. To do so, open the application, click on <code>More ( ... icon)</code>, select <code>Settings</code>, go to <code>Advanced</code> and enable <code>Developer mode</code>.</li><li>PoC Github repository: <a href=https://github.com/martinkubecka/Logseq-XSS-RCE-PoC>https://github.com/martinkubecka/Logseq-XSS-RCE-PoC</a></li><li>PoC video demonstration: <a href="https://www.youtube.com/watch?v=cBP4TA-BioY">https://www.youtube.com/watch?v=cBP4TA-BioY</a></li></ul></blockquote><h3 id=steps-to-reproduce>Steps to Reproduce<a hidden class=anchor aria-hidden=true href=#steps-to-reproduce>#</a></h3><ol><li>Launch the Logseq application.</li><li>In the upper-right corner, click on <code>More ( ... icon)</code>, choose <code>Plugins</code>, then open the <code>Marketplace</code>.</li><li>Click on any available plugin, for example: <code>Journals Calendar</code>.</li><li>Press <code>Ctrl + Shift + I</code> to open <strong>DevTools</strong> and navigate to the <strong>Console</strong> tab.</li><li>Paste and execute the following code to load the malicious README from an attacker-controlled GitHub repository.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;iframe.lsp-frame-readme&#34;</span><span class=p>).</span><span class=nx>src</span> <span class=o>=</span> <span class=s2>&#34;lsp://logseq.com/marketplace.html?repo=martinkubecka/Logseq-Testing&#34;</span><span class=p>;</span>
</span></span></code></pre></div><p>After executing the command above:</p><p>The <code>iframe.lsp-frame-readme</code> source is changed to load the README file from the <code>martinkubecka/Logseq-XSS-RCE-PoC</code> GitHub repository.
This README contains a benign proof-of-concept demonstrating:</p><ul><li>A basic XSS payload: <code>&lt;img src=x onerror="alert('XSS')"></code>.</li><li>A chained XSS to RCE payload using a demonstration system protocol handler, resulting in the calculator app being executed on Windows system: <code>&lt;img src=x onerror="window.location='ms-calculator://'"></code>.</li></ul><p><img loading=lazy src=/images/security-advisories/CVE-2025-56683/icon.png alt="PoC Exploit" title="PoC Exploit"></p><blockquote><p><em>This PoC demonstrates on a benign example the critical impact of unsanitized user input combined with insufficient protocol filtering.</em></p></blockquote><h2 id=recommended-mitigations>Recommended Mitigations<a hidden class=anchor aria-hidden=true href=#recommended-mitigations>#</a></h2><p>To address the DOM-based XSS and RCE risks stemming from the combination of unsanitized HTML rendering and protocol misuse, the following mitigations are recommended:</p><ol><li><strong>Sanitize rendered plugin README content in <code>marketplace.html</code></strong>: Input from the repo query parameter is fetched from GitHub and injected directly into the DOM via innerHTML after being parsed by <code>marked.parse()</code>. This content should be sanitized before being inserted.</li><li><strong>Implement protocol allowlisting in <code>window.cljs</code></strong>: Introduce a strict allowlist of supported protocols and explicitly block others, especially system-level handlers unless explicitly needed for functionality.</li></ol><h2 id=vendor-response--patch-information>Vendor Response & Patch Information<a hidden class=anchor aria-hidden=true href=#vendor-response--patch-information>#</a></h2><p>The Logseq development team responded promptly to the reported <strong>DOM-based XSS</strong> vulnerability by integrating the <strong>DOMPurify</strong> <a href=#references>[5]</a> library to sanitize plugin README content rendered in the marketplace. This change mitigates the risk of arbitrary JavaScript execution originating from attacker-controlled plugin metadata.</p><p>The fix was incorporated in the release based on the <a href=https://github.com/logseq/logseq/tree/feat/db>Logseq DB branch</a>. Relevant code changes include:</p><ul><li>Addition of the <code>dompurify</code> library to the build process in <code>gulpfile.js</code>.</li><li>Inclusion of <code>purify.js</code> in the HTML rendering logic in <code>resources/marketplace.html</code>.</li><li>Sanitization of parsed README content using <code>DOMPurify.sanitize()</code> before injection into the DOM.</li><li>A minor update in <code>plugins.cljs</code> to ensure correct iframe source resolution.</li></ul><p>The patch can be reviewed in this GitHub <a href=https://github.com/logseq/logseq/commit/4cdf49aedd8de073015b6945a529399c3bfa109a#diff-25789e3ba4c2adf4a68996260eb693a441b4a834c38b76167a120f0b51b969f7R72-R74>commit</a>.</p><p>While the <strong>DOM-based XSS</strong> was addressed effectively, the second issue, <strong>Lack of Protocol Validation in Electron&rsquo;s Window Logic</strong>, remained unresolved at the time of patch confirmation. On April 29th, 2025, this concern was explicitly communicated to the Logseq support team along with a recommendation to assign CVE ID(s) to both vulnerabilities.</p><p>Although system-level protocol handlers are not implemented by the Logseq application itself, the lack of strict validation in its <code>shell.openExternal</code> usage enables attackers to exploit them <a href=#references>[6]</a>. Electron&rsquo;s <code>shell.openExternal()</code> API delegates URL handling to the underlying operating system <a href=#references>[7]</a>. Once an attacker achieves JavaScript execution, they can invoke handlers such as <code>search-ms:</code>, <code>ms-excel:</code>, or <code>ms-word:</code> to execute arbitrary commands or launch native applications <a href=#references>[8]</a>. For instance, abuse of the <code>search-ms:</code> handler has enabled attackers to remotely execute files from SMB shares via malicious search window shortcuts <a href=#references>[9]</a>. The infamous Follina vulnerability exploited the <code>ms-msdt:</code> protocol to achieve code execution through a crafted Office document <a href=#references>[10]</a>. Likewise, protocols like <code>ms-excel:</code> and <code>ms-word:</code> have been weaponized in phishing campaigns to silently launch Office apps with remote templates <a href=#references>[11]</a>. Without proper validation and the use of security best practices, even Electron applications that appear sandboxed can be exploited to interact with the underlying operating system in unintended and potentially high-risk ways.</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li>[1] <a href=https://logseq.com/>https://logseq.com/</a></li><li>[2] <a href=https://github.com/logseq/logseq>https://github.com/logseq/logseq</a></li><li>[3] <a href=https://portswigger.net/web-security/cross-site-scripting/dom-based>https://portswigger.net/web-security/cross-site-scripting/dom-based</a></li><li>[4] <a href=https://www.splunk.com/en_us/blog/learn/rce-remote-code-execution.html>https://www.splunk.com/en_us/blog/learn/rce-remote-code-execution.html</a></li><li>[5] <a href=https://github.com/cure53/DOMPurify>https://github.com/cure53/DOMPurify</a></li><li>[6] <a href=https://benjamin-altpeter.de/shell-openexternal-dangers/>https://benjamin-altpeter.de/shell-openexternal-dangers/</a></li><li>[7] <a href=https://www.electronjs.org/docs/latest/tutorial/security#15-do-not-use-shellopenexternal-with-untrusted-content>https://www.electronjs.org/docs/latest/tutorial/security#15-do-not-use-shellopenexternal-with-untrusted-content</a></li><li>[8] <a href=https://positive.security/blog/url-open-rce>https://positive.security/blog/url-open-rce</a></li><li>[9] <a href=https://www.bleepingcomputer.com/news/security/new-windows-search-zero-day-added-to-microsoft-protocol-nightmare/>https://www.bleepingcomputer.com/news/security/new-windows-search-zero-day-added-to-microsoft-protocol-nightmare/</a></li><li>[10] <a href=https://www.splunk.com/en_us/blog/security/follina-for-protocol-handlers.html>https://www.splunk.com/en_us/blog/security/follina-for-protocol-handlers.html</a></li><li>[11] <a href=https://blog.syss.com/posts/abusing-ms-office-protos/>https://blog.syss.com/posts/abusing-ms-office-protos/</a></li></ul><h2 id=timeline>Timeline<a hidden class=anchor aria-hidden=true href=#timeline>#</a></h2><ul><li><strong>2025-04-23</strong>: I disclosed the vulnerabilities to the Logseq support team.</li><li><strong>2025-04-25</strong>: The Logseq support team acknowledged the findings and addressed the DOM-based Cross-Site Scripting (XSS) vulnerability with a fix.</li><li><strong>2025-04-29</strong>: I confirmed the patch for the DOM-based XSS and notified the Logseq support team that the <strong>Lack of Protocol Validation in Electron&rsquo;s Window Logic</strong> remained unaddressed, I also recommended assigning CVE ID(s) to these findings.</li><li><strong>2025-07-08</strong>: Due to no follow-up from the Logseq support team regarding the second vulnerability and CVE assignment, I requested CVE ID(s) directly from MITRE.</li><li><strong>2025-09-30</strong>: CVE ID(s) assigned.</li><li><strong>2025-10-01</strong>: Public release of the security advisory.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://martinkubecka.sk/tags/cve-2025-56683/>CVE-2025-56683</a></li><li><a href=https://martinkubecka.sk/tags/xss/>XSS</a></li><li><a href=https://martinkubecka.sk/tags/dom-based-xss/>DOM-based XSS</a></li><li><a href=https://martinkubecka.sk/tags/logseq/>Logseq</a></li></ul><nav class=paginav><a class=next href=https://martinkubecka.sk/security-advisories/cve-2023-47622/><span class=title>Next »</span><br><span>CVE-2023-47622: Multiple Reflected Cross-Site Scripting Vulnerabilities in IT Service Management platform iTop</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://martinkubecka.sk>Martin Kubečka</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let b=document.querySelector("#menu-trigger"),m=document.querySelector(".menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(e){b.contains(e.target)||m.classList.add("hidden")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>