<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress | Martin Kubečka</title><meta name=keywords content="CVE-2021-41434,XSS,FlatPress,Stored XSS"><meta name=description content="Stored XSS vulnerability in FlatPress 1.2.1 allows arbitrary JavaScript execution via crafted post content."><meta name=author content="Martin Kubečka"><link rel=canonical href=https://martinkubecka.sk/security-advisories/cve-2021-41432/><link crossorigin=anonymous href=/assets/css/stylesheet.ba00c1f715cc18cbf534f1dd7be1b22fc29e5384ca42c46b68ff6c99b2b92143.css integrity="sha256-ugDB9xXMGMv1NPHde+GyL8KeU4TKQsRraP9smbK5IUM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://martinkubecka.sk/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://martinkubecka.sk/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://martinkubecka.sk/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://martinkubecka.sk/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://martinkubecka.sk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress"><meta property="og:description" content="Stored XSS vulnerability in FlatPress 1.2.1 allows arbitrary JavaScript execution via crafted post content."><meta property="og:type" content="article"><meta property="og:url" content="https://martinkubecka.sk/security-advisories/cve-2021-41432/"><meta property="og:image" content="https://martinkubecka.sk/images/security-advisories/CVE-2021-41432/icon.png"><meta property="article:section" content="security-advisories"><meta property="article:published_time" content="2022-06-22T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-22T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://martinkubecka.sk/images/security-advisories/CVE-2021-41432/icon.png"><meta name=twitter:title content="CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress"><meta name=twitter:description content="Stored XSS vulnerability in FlatPress 1.2.1 allows arbitrary JavaScript execution via crafted post content."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Security Advisories","item":"https://martinkubecka.sk/security-advisories/"},{"@type":"ListItem","position":3,"name":"CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress","item":"https://martinkubecka.sk/security-advisories/cve-2021-41432/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress","name":"CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress","description":"Stored XSS vulnerability in FlatPress 1.2.1 allows arbitrary JavaScript execution via crafted post content.","keywords":["CVE-2021-41434","XSS","FlatPress","Stored XSS"],"articleBody":"Vulnerability Summary A Stored Cross-Site Scripting (XSS) vulnerability exists in version 1.2.1 of the FlatPress application. This vulnerability allows an authenticated attacker to inject malicious JavaScript code into blog content, which will execute in the context of any user visiting the affected page.\nStored XSS occurs when user-supplied input is stored on the server (e.g., in a database or file system) and later rendered in a web page without proper encoding or sanitization. This can lead to session hijacking, defacement, or redirection to malicious sites.\nCVSS v3.1 Metrics Metric Value Base Score 5.4 (MEDIUM) Vector CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N Weakness Enumeration CWE ID Description CWE-79 Improper Neutralization of Input During Web Page Generation (‘Cross-site Scripting’) Proof of Concept (PoC) Steps to Reproduce Log in to the FlatPress administration area. Navigate to Entries → Write Entry. Enter any value in the Subject field. In the Content area, insert the following payload: \u003cscript\u003ealert(document.cookie)\u003c/script\u003e Click the Save \u0026 Continue button. The stored XSS payload is now saved and will be executed whenever the post is viewed. Navigate to the FlatPress homepage to verify the execution of the payload. Suggested Mitigations Properly encode all dynamic content before rendering in HTML. Sanitize user inputs server-side using am HTML sanitization library. Implement Content Security Policy (CSP) headers to mitigate script injection. References https://flatpress.org/ https://www.cve.org/CVERecord?id=CVE-2021-41432 https://nvd.nist.gov/vuln/detail/CVE-2021-41434 https://portswigger.net/web-security/cross-site-scripting/stored https://owasp.org/www-community/attacks/xss/ ","wordCount":"218","inLanguage":"en","image":"https://martinkubecka.sk/images/security-advisories/CVE-2021-41432/icon.png","datePublished":"2022-06-22T00:00:00Z","dateModified":"2022-06-22T00:00:00Z","author":{"@type":"Person","name":"Martin Kubečka"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://martinkubecka.sk/security-advisories/cve-2021-41432/"},"publisher":{"@type":"Organization","name":"Martin Kubečka","logo":{"@type":"ImageObject","url":"https://martinkubecka.sk/images/favicon/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://martinkubecka.sk accesskey=h title="$ cd /home/ (Alt + H)">$ cd /home/</a><div class=logo-switches></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://martinkubecka.sk/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://martinkubecka.sk/security-advisories/ title="Security Advisories"><span>Security Advisories</span></a></li><li><a href=https://martinkubecka.sk/library/ title=Library><span>Library</span></a></li><li><a href=https://martinkubecka.sk/about/ title=About><span>About</span></a></li><li><a href=https://martinkubecka.sk/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://openguards.martinkubecka.sk/ title=OpenGuards><span>OpenGuards</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://martinkubecka.sk>Home</a>&nbsp;»&nbsp;<a href=https://martinkubecka.sk/security-advisories/>Security Advisories</a></div><h1 class=post-title>CVE-2021-41432: Stored Cross-Site Scripting Vulnerability in the Blog Content in FlatPress</h1><div class=post-description>Stored XSS vulnerability in FlatPress 1.2.1 allows arbitrary JavaScript execution via crafted post content.</div><div class=post-meta><span title='2022-06-22 00:00:00 +0000 +0000'>June 22, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;218 words&nbsp;·&nbsp;Martin Kubečka</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#vulnerability-summary>Vulnerability Summary</a><ul><li><a href=#cvss-v31-metrics>CVSS v3.1 Metrics</a></li><li><a href=#weakness-enumeration>Weakness Enumeration</a></li></ul></li><li><a href=#proof-of-concept-poc>Proof of Concept (PoC)</a><ul><li><a href=#steps-to-reproduce>Steps to Reproduce</a></li></ul></li><li><a href=#suggested-mitigations>Suggested Mitigations</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h2 id=vulnerability-summary>Vulnerability Summary<a hidden class=anchor aria-hidden=true href=#vulnerability-summary>#</a></h2><p>A <strong>Stored Cross-Site Scripting (XSS)</strong> vulnerability exists in version 1.2.1 of the FlatPress application. This vulnerability allows an authenticated attacker to inject malicious JavaScript code into blog content, which will execute in the context of any user visiting the affected page.</p><blockquote><p><em>Stored XSS occurs when user-supplied input is stored on the server (e.g., in a database or file system) and later rendered in a web page without proper encoding or sanitization. This can lead to session hijacking, defacement, or redirection to malicious sites.</em></p></blockquote><h3 id=cvss-v31-metrics>CVSS v3.1 Metrics<a hidden class=anchor aria-hidden=true href=#cvss-v31-metrics>#</a></h3><table><thead><tr><th>Metric</th><th>Value</th></tr></thead><tbody><tr><td>Base Score</td><td>5.4 (<strong>MEDIUM</strong>)</td></tr><tr><td>Vector</td><td><code>CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N</code></td></tr></tbody></table><h3 id=weakness-enumeration>Weakness Enumeration<a hidden class=anchor aria-hidden=true href=#weakness-enumeration>#</a></h3><table><thead><tr><th>CWE ID</th><th>Description</th></tr></thead><tbody><tr><td><a href=http://cwe.mitre.org/data/definitions/79.html>CWE-79</a></td><td>Improper Neutralization of Input During Web Page Generation (&lsquo;Cross-site Scripting&rsquo;)</td></tr></tbody></table><h2 id=proof-of-concept-poc>Proof of Concept (PoC)<a hidden class=anchor aria-hidden=true href=#proof-of-concept-poc>#</a></h2><h3 id=steps-to-reproduce>Steps to Reproduce<a hidden class=anchor aria-hidden=true href=#steps-to-reproduce>#</a></h3><ol><li>Log in to the FlatPress administration area.</li><li>Navigate to <strong>Entries → Write Entry</strong>.</li><li>Enter any value in the <strong>Subject</strong> field.</li><li>In the <strong>Content</strong> area, insert the following payload:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>script</span><span class=o>&gt;</span><span class=nx>alert</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>)</span><span class=o>&lt;</span><span class=err>/script&gt;</span>
</span></span></code></pre></div><p><img loading=lazy src=/images/security-advisories/CVE-2021-41432/xss_payload.png alt="XSS Payload" title="XSS Payload"></p><ol start=5><li>Click the Save & Continue button.</li><li>The stored XSS payload is now saved and will be executed whenever the post is viewed.</li><li>Navigate to the FlatPress homepage to verify the execution of the payload.</li></ol><p><img loading=lazy src=/images/security-advisories/CVE-2021-41432/payload_trigger.png alt="XSS Payload Trigger" title="XSS Payload Trigger"></p><h2 id=suggested-mitigations>Suggested Mitigations<a hidden class=anchor aria-hidden=true href=#suggested-mitigations>#</a></h2><ul><li>Properly encode all dynamic content before rendering in HTML.</li><li>Sanitize user inputs server-side using am HTML sanitization library.</li><li>Implement Content Security Policy (CSP) headers to mitigate script injection.</li></ul><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://flatpress.org/>https://flatpress.org/</a></li><li><a href="https://www.cve.org/CVERecord?id=CVE-2021-41432">https://www.cve.org/CVERecord?id=CVE-2021-41432</a></li><li><a href=https://nvd.nist.gov/vuln/detail/CVE-2021-41434>https://nvd.nist.gov/vuln/detail/CVE-2021-41434</a></li><li><a href=https://portswigger.net/web-security/cross-site-scripting/stored>https://portswigger.net/web-security/cross-site-scripting/stored</a></li><li><a href=https://owasp.org/www-community/attacks/xss/>https://owasp.org/www-community/attacks/xss/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://martinkubecka.sk/tags/cve-2021-41434/>CVE-2021-41434</a></li><li><a href=https://martinkubecka.sk/tags/xss/>XSS</a></li><li><a href=https://martinkubecka.sk/tags/flatpress/>FlatPress</a></li><li><a href=https://martinkubecka.sk/tags/stored-xss/>Stored XSS</a></li></ul><nav class=paginav><a class=prev href=https://martinkubecka.sk/security-advisories/cve-2021-41433/><span class=title>« Prev</span><br><span>CVE-2021-41433: Authentication Bypass in Resumes Management by EGavilan Media</span></a>
<a class=next href=https://martinkubecka.sk/security-advisories/cve-2021-41434/><span class=title>Next »</span><br><span>CVE-2021-41434: Stored Cross-Site Scripting Vulnerability in Expense Management System by EGavilan Media</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://martinkubecka.sk>Martin Kubečka</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let b=document.querySelector("#menu-trigger"),m=document.querySelector(".menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(e){b.contains(e.target)||m.classList.add("hidden")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>