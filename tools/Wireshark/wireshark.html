<!DOCTYPE HTML>
<html>

<head>
    <title>Wireshark</title>
    <link rel="apple-touch-icon" sizes="180x180" href="../../images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon/favicon-16x16.png">
    <link rel="manifest" href="../../images/favicon/site.webmanifest">
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="stylesheet" href="../../assets/css/main.css"/>
    <noscript>
        <link rel="stylesheet" href="../../assets/css/noscript.css"/>
    </noscript>
</head>

<body class="is-preload">

<!-- Wrapper -->
<div id="wrapper">

    <!-- Header -->
    <header id="header" class="alt">
        <nav>
            <a href="#menu">Menu</a>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <ul class="links">
            <li><a href="../../index.html">Home</a></li>
            <li><a href="../../tools_landing.html">Hacking Tools</a></li>
            <li><a href="../../linux_landing.html">Vulnerabilities on Linux</a></li>
            <li><a href="../../windows_landing.html">Vulnerabilities on Windows</a></li>
            <li><a href="../../web_landing.html">Vulnerabilities on Web</a></li>
            <li><a href="../../malware_analyses_landing.html">Malware Analysis</a></li>
            <li><a href="../../network_services_landing.html">Network Services</a></li>
            <li><a href="../../ctf_landing.html">Capture the Flag</a></li>
            <li><a href="../../miscellaneous_landing.html">Miscellaneous</a></li>
            <li><a href="https://github.com/martinkubecka"><img alt="Github" src="../../images/github_logo.png"/></a>
            </li>
        </ul>
    </nav>

    <!-- Main -->
    <div id="main" class="alt">

        <!-- One -->
        <section id="one">
            <div class="inner">
                <header class="major">
                    <h1>Wireshark</h1>
                </header>

                <span style="font-size: 16pt">2020/11/05<br/><br/></span>

                <ul>
                    <li>Packet Filtering is a very important part of packet analysis especially when you have a very
                        large number of packets.
                    </li>
                    <li>You can apply display captures in two ways: through the analyze tab and at the filter bar at
                        the top of the packet capture.
                    </li>
                </ul>
                <br/>
                <ul>
                    <li><u>Filtering Operators</u></li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none">and - operator:
                                <b>and</b>&nbsp;/<b>&nbsp;&amp;&amp;</b></li>
                            <li style="list-style-type: none">or - operator: <b>or</b>&nbsp;/ <b>||</b></li>
                            <li style="list-style-type: none">equals - operator: <b>eq</b>&nbsp;/ <b>==</b></li>
                            <li style="list-style-type: none">not equal - operator: <b>ne</b>&nbsp;/ <b>!=</b></li>
                            <li style="list-style-type: none">greater than - operator: <b>gt</b>&nbsp;/
                                &nbsp;<b>&gt;</b></li>
                            <li style="list-style-type: none">less than - operator: <b>lt</b>&nbsp;/ <b>&lt;</b>
                            </li>
                        </ul>
                    </li>
                </ul>
                <br/>
                <ul>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>Basic Filtering</b></span>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li><u>Filtering by IP:</u></li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li>This filter will allow you to comb through the traffic and only see packets
                                        with a specific IP address contained in those packets, whether it be from
                                        the source or destination.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><u>Syntax:</u>&nbsp;<i>ip.addr == &lt;IP
                                Address&gt;</i></li>
                        </ul>
                    </li>
                </ul>
                <br/>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li><u>Filtering by SRC and DST</u>:</li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li>These filters allow us to filter the traffic by the source and destination
                                        from which the traffic is coming from.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><u>Syntax:</u>&nbsp;<i>ip.src == &lt;SRC IP
                                Address&gt; and ip.dst == &lt;DST IP Address&gt; </i></li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li><u>Filtering by TCP Protocols:</u></li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li>This allows you to set a port or protocol to filter by and can be handy when
                                        trying to keep track of an unusual protocol or port being used.
                                    </li>
                                    <li>Wireshark can filter by both port numbers as well as protocol names.</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><u>Syntax:</u>&nbsp;<i>tcp.port eq &lt;Port #&gt; or
                                &lt;Protocol Name&gt;</i></li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li><u>Filtering by UDP Protocols:</u>&nbsp;filter by UDP ports by changing the prefix
                                from tcp to udp
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><u>Syntax:</u>&nbsp;<i>udp.port eq &lt;Port #&gt; or
                                &lt;Protocol Name&gt;</i></li>
                            <i>
                                <li style="list-style-type: none"></li>
                            </i>
                        </ul>
                    </li>
                </ul>
                <hr/>
                <ul>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt">&nbsp;Packet
									Details</span></b></li>
                    <li style="list-style-type: none"></li>
                    <li>Packets consist of 5 to 7 layers based on the OSI model<b>.</b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">&nbsp;<img src="image.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li><u>7 distinct layers to the packet:</u></li>
                    <li style="list-style-type: none">
                        <ul><b>
                            <li>frame/packet</li>
                            <li>source [MAC]</li>
                            <li>source [IP]</li>
                            <li>protocol</li>
                            <li>protocol errors</li>
                            <li>application protocol</li>
                        </b>
                            <li><b>application data</b></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">&nbsp;<img src="image 2.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Frame (Layer 1) </b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This will show you what frame / packet you are looking at as well as details
                                specific to the <b>Physical layer</b>&nbsp;of the OSI model.
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 3.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Source [MAC] (Layer 2)</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This will show you the source and destination MAC Addresses; from the<b>&nbsp;Data
                                Link </b>layer of the OSI model.
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 4.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Source [IP] (Layer 3)</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This will show you the source and destination IPv4 Addresses; from the <b>Network
                                layer</b>&nbsp;of the OSI model.
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 5.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Protocol (Layer 4)</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This will show you details of the protocol used (UDP/TCP) along with source and
                                destination ports; from the <b>Transport layer</b>&nbsp;of the OSI model.
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 6.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Protocol Errors</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This is a continuation of the 4th layer showing specific segments from TCP that
                                needed to be reassembled.
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 7.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Application Protocol (Layer 5)</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This will show details specific to the protocol being used such HTTP, FTP, SMB, etc.
                                From the <b>Application layer</b>&nbsp;of the OSI model.
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><img src="image 8.png"/></li>
                </ul>
                <br/>
                <ul>
                    <li><b>Application Data</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>This is an extension of layer 5 that can show the application-specific data.</li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 9.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <hr/>
                <ul><span style="font-size: 12pt"><b>
								<li style="list-style-type: none">ARP Overview</li>
							</b></span>
                    <li style="list-style-type: none"></li>
                    <li>Address Resolution Protocol is a <b>Layer 2 </b>protocol that is used to connect IP
                        Addresses with MAC Addresses.
                    </li>
                    <li>They will contain REQUEST messages and RESPONSE messages.</li>
                </ul>
                <ul>
                    <li>To identify packets the message header will contain one of two operation codes:</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul><b>
                            <li style="list-style-type: none">Request (1)</li>
                        </b>
                            <li style="list-style-type: none"><b>Reply (2)</b></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 10.png"/></li>
                    <i>
                        <li style="list-style-type: none"></li>
                    </i>
                    <li style="list-style-type: none"><i>packet capture of multiple ARP requests and replies</i>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>Most devices will identify themselves or Wireshark will identify <b>Intel_78</b>, as an
                        example of suspicious traffic:
                    </li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>many requests from an unrecognized source</li>
                        </ul>
                    </li>
                    <li>Resolve physical addresses:</li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>navigate to View &gt; Name Resolution &gt; Ensure that Resolve Physical Addresses is
                                checked
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 11.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><i>Cisco device is sending ARP Requests</i></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>ARP Traffic
									Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><u>ARP Request Packets:</u></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><img src="image 12.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>The most important details of the packet are outlined in red</li>
                    <li>The <b>Opcode</b>&nbsp;is short for <i>operation code</i>&nbsp;and will you tell you whether
                        it is an ARP Request or Reply.
                    </li>
                    <li>The second outlined detail is to <b>where the packet is requesting to</b>, in this case, it
                        is broadcasting the request to all.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><u>ARP Reply Packets:</u></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><img src="image 13.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"></li>
                        </ul>
                    </li>
                    <li>The <b>Opcode</b>&nbsp;is an ARP Reply packet.</li>
                    <li>Other useful information like the <b>MAC</b>&nbsp;and <b>IP Address</b>&nbsp;that was sent
                        along with the reply (know that this was the information sent along with the message).
                    </li>
                </ul>
                <br/>
                <ul>
                    <li style="list-style-type: none"><u><span style="font-size: 12pt"><b>Practical ARP Packet
										Analysis</b></span></u></li>
                </ul>
                <br/>
                <ul><b>
                    <li style="list-style-type: none">#1 What is the Opcode for Packet 6?</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 15.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">#2 What is the source MAC Address of Packet 19?</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 16.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">#3 What 4 packets are Reply packets?</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 14.png"/></li>
                    <li style="list-style-type: none"></li>
                </b>
                    <li style="list-style-type: none"><b>#4 What IP Address is at 80:fb:06:f0:45:d7?</b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 17.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <br/>
                <hr/>
                <ul>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt">ICMP Overview</span></b></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Internet Control Message Protocol</b>&nbsp;is used to analyze various nodes on a network.
                    </li>
                    <li>Most commonly used with utilities like ping and traceroute.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 18.png"/></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><i>ping - we can see a request to the server from ICMP, then a
                        reply from the server</i></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>ICMP Traffic
									Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><u>ICMP request:</u></li>
                    <li style="list-style-type: none"></li>
                    <li>Important things within the packet details:</li>
                    <li style="list-style-type: none">
                        <ul>
                            <li><u>type</u></li>
                            <li style="list-style-type: none"></li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li>A type that equals <b>8 means that it is a request packet</b>, if it is
                                        equal to<b>&nbsp;0 it is a reply packet.</b></li>
                                </ul>
                            </li>
                            <li style="list-style-type: none"></li>
                            <li><u>code of the packet</u></li>
                            <li style="list-style-type: none"></li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li>When these codes are altered or do not seem correct that is typically a sign
                                        of suspicious activity.
                                    </li>
                                </ul>
                            </li>
                            <li style="list-style-type: none"></li>
                            <li><u>timestamp</u></li>
                            <li style="list-style-type: none"></li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li style="list-style-type: none">The timestamp can be useful for identifying
                                        the time the ping was requested it can also be useful to identify suspicious
                                        activity in some cases.
                                    </li>
                                </ul>
                            </li>
                            <li style="list-style-type: none"></li>
                            <li><u>data</u></li>
                            <li style="list-style-type: none"></li>
                            <li style="list-style-type: none">
                                <ul>
                                    <li style="list-style-type: none">We can also look at the data string which will
                                        typically just be a random data string.
                                    </li>
                                </ul>
                            </li>
                            <li style="list-style-type: none"></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 19.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><i>packet details for a ping request packet</i></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><u>ICMP Reply:</u></li>
                    <li style="list-style-type: none"></li>
                    <li>Difference that distinguishes a reply packet is the code (in this case, you can see it is 0
                        - reply packet)
                    </li>
                    <li style="list-style-type: none"></li>
                    <li>The same analysis techniques for Request packet.</li>
                    <li>The main difference will be the packet type.</li>
                </ul>
                <br/>
                <ul>
                    <li style="list-style-type: none"><img src="image 20.png"/></li>
                </ul>
                <ul><i>
                    <li style="list-style-type: none">reply packet</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                </i><span style="font-size: 12pt"><u><b>
									<li style="list-style-type: none">Practical ICMP Packet Analysis</li>
								</b></u></span></ul>
                <ul><b>
                    <li style="list-style-type: none">#1 What is the type for packet 4?</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 21.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">#2 What is the type for packet 5?</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 22.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">#3 What is the timestamp for packet 12, only including
                        month day and year?
                    </li>
                </b>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none">Wireshark bases it’s time off of your devices time
                                zone, if your answer is wrong try one day more or less.
                            </li>
                        </ul>
                    </li>
                    <b>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 23.png"/></li>
                        <li style="list-style-type: none"></li>
                    </b>
                    <li style="list-style-type: none"><b>#4 What is the full data string for packet 18?</b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 24.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <br/>
                <hr/>
                <ul>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>TCP Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Transmission Control Protocol</b>&nbsp;handles the delivery of packets including
                        sequencing and errors.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">Below you can see a sample of a</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 25.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><i>Nmap scan - scanning port 80 and 443 (port is closed due to
                        the RST, ACK packet in red)</i></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>TCP Traffic
									Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">A common thing that you will see when analyzing TCP packets is
                        known as the TCP handshake, which you should already be familiar with. It includes a series
                        of packets: syn, synack, ack; That allows devices to establish a connection.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 26.png"/></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">Typically when this handshake is out of order or when it
                        includes other packets like an RST packet, something suspicious or wrong is happening in the
                        network. The Nmap scan in the section above is a perfect example of this.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>TCP Packet
									Analysis</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 27.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><i>packet details for an SYN packet</i></li>
                    <li style="list-style-type: none"></li>
                    <li>The main thing that we want to look for when looking at a TCP packet is the <b>sequence
                        number</b>&nbsp;and <b>acknowledgment number</b>.
                    </li>
                    <li>In this case, we see that the port was not open because the <b>acknowledgment
                        number</b>&nbsp;is 0.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>Within Wireshark, we can also see the <b>original sequence number</b>&nbsp;by navigating to
                        <i>edit &gt; preferences &gt; protocols &gt; TCP &gt; relative sequence numbers (uncheck
                            boxes).</i></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 28.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 29.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <br/>
                <hr/>
                <ul>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>DNS Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Domain Name Service </b>protocol is used to resolves names with IP addresses.</li>
                    <li style="list-style-type: none"></li>
                    <li>Things outlined below that you should keep in the back of your mind when analyzing DNS
                        packets:
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul><b>
                            <li style="list-style-type: none">Query-Response</li>
                            <li style="list-style-type: none">DNS-Servers Only</li>
                            <li style="list-style-type: none">UDP</li>
                        </b>
                            <li style="list-style-type: none"></li>
                        </ul>
                    </li>
                    <li>If anyone of these is out of place then the packets should be looked at further and should
                        be considered suspicious.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 30.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><i>multiple DNS queries and responses</i></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">Instantly looking at the packets we can see what they are
                        querying, this can be useful when you have many packets and need to identify suspicious or
                        unusual traffic quickly.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt">DNS Traffic
									Overview</span></b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><u>DNS Query:</u></li>
                    <li style="list-style-type: none"></li>
                    <li>We have two bits of information that we can use to analyze the packet.</li>
                    <li>The first bit of information is <b>where the query is originating from</b></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>UDP 53 which means that this packet passes that check</li>
                            <li>if it was TCP 53 then it should be considered suspicious traffic and needs to
                                analyzed further
                            </li>
                        </ul>
                    </li>
                    <li><b>Queryies</b>&nbsp;can be useful with other information to build a story of what happened
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 31.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><u>DNS Response:</u></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Response packet</b>, similar to the query packet</li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>but it includes an answer which can be used to verify the query</li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><img src="image 32.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt"><u>Practical DNS Packet
										Analysis</u></span></b></li>
                    <li style="list-style-type: none"></li>
                    <b>
                        <li style="list-style-type: none">#1 What is being queried in packet 1?</li>
                        <li style="list-style-type: none"><img src="image 53.png"/></li>
                    </b>
                </ul>
                <ul><b>
                    <li style="list-style-type: none">#2 What site is being queried in packet 26?</li>
                </b></ul>
                <ul><b>
                    <li style="list-style-type: none"><img src="image 54.png"/></li>
                </b></ul>
                <ul><b>
                    <li style="list-style-type: none">#3 What is the Transaction ID for packet 26?</li>
                </b>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 55.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <br/>
                <hr/>
                <ul>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>HTTP Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li><b>Hypertext Transfer Protocol</b>&nbsp;is a commonly used port for the world wide web and
                        used by some websites
                    </li>
                    <li>HTTP is used to send <b>GET</b>&nbsp;and <b>POST</b>&nbsp;<b>requests</b>&nbsp;to a web
                        server in order to receive things like webpages.
                    </li>
                    <li>Knowing how to analyze HTTP can be helpful to quickly spot things like <i>SQLi</i>, <i>Web
                        Shells</i>, and other web-related attack vectors.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <span style="font-size: 12pt"><b>
								<li style="list-style-type: none">HTTP Traffic Overview</li>
							</b></span>
                    <li style="list-style-type: none"></li>
                    <li>Does not include any handshakes or prerequisites before communication.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 33.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>Looking at an HTTP packet we can easily gather information since the data stream is not
                        encrypted.
                    </li>
                    <li>Some of the important information we can gather from the packet is the <i>Request URI, File
                        Data, Server.</i></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt"><u>Practical HTTP Packet
										Analysis</u></span></b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 34.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 35.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><i>details of one of the HTTP requests packet</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li>From this packet we can identify some very important information like the
                        <b>host</b>,<b>&nbsp;user-agent</b>, <b>requested URI</b>, and <b>response</b>.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li>Useful feature in Wireshark to organize the protocols present in a capture
                        the<b>&nbsp;<u>Protocol Hierarchy</u></b>.
                    </li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Navigate to <i>Statistics &gt; Protocol Hierarchy</i></li>
                        </ul>
                    </li>
                </ul>
                &nbsp;<ul>
                <li style="list-style-type: none"><img src="image 36.png"/></li>
            </ul>
                <ul>
                    <li>Useful in practical applications like<i>&nbsp;threat hunting</i>&nbsp;to identify
                        discrepancies in packet captures.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li><u><b>Export HTTP Object</b></u>&nbsp;will allow us to organize all requested URIs in the
                        capture
                    </li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Navigate to <i>File &gt; Export Objects &gt; HTTP</i></li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><img src="image 37.png"/></li>
                </ul>
                <ul>
                    <li>Useful to quickly identify possible discrepancies in captures.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>&nbsp;<u><b>Endpoints</b></u>&nbsp;allows the user to organize all endpoints and IPs found
                        within a specific capture. &nbsp;
                    </li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Navigate to <i>Statistics &gt; Endpoints</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 38.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li>Useful to identify where a discrepancy is originating from.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <b>
                        <li style="list-style-type: none">#1 What percent of packets originate from Domain Name
                            System?
                        </li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 56.png"/></li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none">#2 What endpoint ends in .237?</li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 57.png"/></li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none">#3 What is the user-agent listed in packet 4?</li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 58.png"/></li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none">#4 Looking at the data stream what is the full request URI
                            from packet 18?
                        </li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 59.png"/></li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none">#5 What domain name was requested from packet 38?</li>
                        <li style="list-style-type: none">#6 Looking at the data stream what is the full request URI
                            from packet 38?
                        </li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 60.png"/></li>
                        <li style="list-style-type: none"></li>
                    </b>
                </ul>
                <br/>
                <hr/>
                <ul>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>HTTPS Overview</b></span>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li><b>Hypertext Transfer Protocol Secure</b>&nbsp;is an extension of the HTT).</li>
                    <li>It is used for secure communication over a computer network, and is widely used on the
                        Internet.
                    </li>
                    <li>The communication protocol is encrypted using <b>Transport Layer Security</b>&nbsp;(TLS) or,
                        formerly, Secure Sockets Layer (SSL).
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>HTTPS Traffic
									Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li>Before sending encrypted information the client and server need to agree upon various steps
                        in order to make a secure tunnel.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Client and server agree on a <i>protocol version</i></li>
                            <li>Client and server select a <i>cryptographic algorithm</i></li>
                            <li>The client and server can authenticate to each other; this step is optional</li>
                            <li>Creates a <i>secure tunnel with a public key</i></li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 39.png"/></li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><i>Client Hello packet showing the SSLv2 Record Layer,
                                Handshake Type, and SSL Version</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 40.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><i>Server Hello packet is sending similar information
                                as the Client Hello packet however this time it includes session details and SSL
                                certificate information</i></li>
                        </ul>
                    </li>
                </ul>
                <br/>
                <ul>
                    <li style="list-style-type: none"><img src="image 41.png"/></li>
                </ul>
                <ul>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><i>Client Key Exchange packet, this part of the
                                handshake will determine the public key to use to encrypt further messages
                                between the Client and Server</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 42.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"><i>Server confirms the public key and create the
                                secure tunnel, all traffic after this point will be encrypted based on the
                                agreed-upon specifications listed above</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 43.png"/></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none"></li>
                            <li style="list-style-type: none"><i>The traffic between the Client and the Server is
                                now encrypted and you will need the secret key in order to decrypt the data
                                stream being sent between the two hosts.</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b><u>Practical HTTPS Packet
										Analysis</u></b></span></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 44.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li>All of the requests are encrypted: HTTPS handshake as well as the encrypted requests
                        themselves.
                    </li>
                </ul>
                <br/>
                <ul>
                    <li>Let's take a closer look at one of the encrypted requests: Packet 11.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 45.png"/></li>
                </ul>
                <ul>
                    <li>You can use an <b>RSA key</b>&nbsp;in Wireshark in order to view the data unencrypted.</li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Navigate to <i>Edit &gt; Preferences &gt; Protocols &gt; TLS &gt; &nbsp;[+]</i></li>
                            <li>You will need to fill in the various sections on the menu with the following
                                preferences:
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li style="list-style-type: none">
                                <ul>
                                    <li style="list-style-type: none">IP Address: 127.0.0.1</li>
                                    <li style="list-style-type: none">Port: start_tls</li>
                                    <li style="list-style-type: none">Protocol: http</li>
                                    <li style="list-style-type: none">Keyfile: RSA key location</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 46.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>&nbsp;RSA key imported into Wireshark : data stream is now unencrypted.</li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><img src="image 47.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <ul>
                    <li>HTTP requests in now unencrypted data streams.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 48.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <ul>
                    <li>Important information such as the<b>&nbsp;request URI </b>and the <b>User-Agent</b>&nbsp;are
                        useful in practical applications of Wireshark such as <i>threat hunting</i>&nbsp;and
                        <i>network administration</i>.
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li>Organize the data stream</li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Navigate to <i>File &gt; Export Objects &gt; HTTP</i></li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 49.png"/>&#09;</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <b>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none">#1 Looking at the data stream what is the full request URI
                            for packet 31?
                        </li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 61.png"/></li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none">#2 Looking at the data stream was is the full request URI
                            for packet 50?
                        </li>
                        <li style="list-style-type: none"></li>
                        <li style="list-style-type: none"><img src="image 62.png"/></li>
                        <li style="list-style-type: none"></li>
                    </b>
                    <li style="list-style-type: none"><b>#3 What is the User-Agent listed in packet 50?</b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 63.png"/></li>
                    <li style="list-style-type: none"></li>
                </ul>
                <hr/>
                <ul>
                    <li style="list-style-type: none"><span style="font-size: 12pt"><b>Zerologon (CVE-2020-1472)
									PCAP Overview</b></span></li>
                    <li style="list-style-type: none"></li>
                    <li>The scenario within the PCAP file contains a <i>Windows Domain Controller</i>&nbsp;with a
                        private IP of <i>192.168.100.6</i>&nbsp;and an <i>attacker</i>&nbsp;with the private IP of
                        <i>192.168.100.128</i>.
                    </li>
                </ul>
                <br/>
                <ul>
                    <li style="list-style-type: none"><img src="image 50.png"/></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt">Identifying the
									Attacker</span></b></li>
                    <li style="list-style-type: none"></li>
                    <li>Some things that may be out of the ordinary:</li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>First, we see some normal traffic from OpenVPN, ARP, etc.</li>
                            <li>Then identify unknown protocols in this case <i>DCERPC</i>&nbsp;and <i>EPM</i>.</li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                    <li>192.168.100.128 is sending all of the requests, device is the attacker.</li>
                    <li>Ccontinue looking at packets coming from this IP to narrow down our hunt.</li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt">Zerologon POC Connection
									Analysis</span></b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 51.png"/></li>
                </ul>
                <ul>
                    <li>Filter for the src of the attacker IP &nbsp;</li>
                    <li>When analyzing PCAPS we need to be aware of <b>Indicators of Compromise (IOCs)</b>&nbsp;
                    </li>
                    <li>Known as <i>Threat Intelligence</i></li>
                    <li style="list-style-type: none">
                        <ul>
                            <li>Zerologon exploit uses multiple RPC connections, and DCERPC requests to change the
                                machine account password, which could be verified with the PCAP.
                            </li>
                        </ul>
                    </li>
                    <li style="list-style-type: none"></li>
                </ul>
                <ul>
                    <li style="list-style-type: none"><b><span style="font-size: 12pt"><u>Secretsdump SMB
										Analysis</u></span></b></li>
                    <li style="list-style-type: none"></li>
                    <li style="list-style-type: none"><img src="image 52.png"/></li>
                </ul>
                <ul>
                    <li>SMB2/3 traffic and DRSUAPI traffic</li>
                    <li>With prior knowledge of the attack we know that it uses secretsdump to dump hashes.</li>
                    <li>Secretsdump abuses <i>SMB2/3 </i>and <i>DRSUAPI</i>&nbsp;to do this, so we can assume that
                        this traffic is secretsdump.
                    </li>
                </ul>


            </div>
        </section>
    </div>

    <!-- Contact -->
    <section id="contact">
        <div class="inner">
        </div>
    </section>

    <!-- Footer -->
    <footer id="footer">
        <div class="inner">
        </div>
    </footer>

</div>

<!-- Scripts -->
<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/jquery.scrolly.min.js"></script>
<script src="../../assets/js/jquery.scrollex.min.js"></script>
<script src="../../assets/js/browser.min.js"></script>
<script src="../../assets/js/breakpoints.min.js"></script>
<script src="../../assets/js/util.js"></script>
<script src="../../assets/js/main.js"></script>

</body>

</html>